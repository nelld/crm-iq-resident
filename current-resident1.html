<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Current Resident</title>
    <!-- Google Fonts - Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome Free -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                    colors: {
                        border: "hsl(var(--border))",
                        input: "hsl(var(--input))",
                        ring: "hsl(var(--ring))",
                        background: "hsl(var(--background))",
                        foreground: "hsl(var(--foreground))",
                        primary: {
                            DEFAULT: "hsl(var(--primary))",
                            foreground: "hsl(var(--primary-foreground))",
                        },
                        secondary: {
                            DEFAULT: "hsl(var(--secondary))",
                            foreground: "hsl(var(--secondary-foreground))",
                        },
                        destructive: {
                            DEFAULT: "hsl(var(--destructive))",
                            foreground: "hsl(var(--destructive-foreground))",
                        },
                        muted: {
                            DEFAULT: "hsl(var(--muted))",
                            foreground: "hsl(var(--muted-foreground))",
                        },
                        accent: {
                            DEFAULT: "hsl(var(--accent))",
                            foreground: "hsl(var(--accent-foreground))",
                        },
                        card: {
                            DEFAULT: "hsl(var(--card))",
                            foreground: "hsl(var(--card-foreground))",
                        },
                    },
                    borderRadius: {
                        lg: "var(--radius)",
                        md: "calc(var(--radius) - 2px)",
                        sm: "calc(var(--radius) - 4px)",
                    },
                }
            }
        }
    </script>
    
    <link rel="stylesheet" href="styles.css?v=190">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="left-section">
                <img src="images/crm-iq-logo.png" alt="CRM IQ" class="logo">
                <nav class="nav-menu">
                    <div class="nav-item">
                        <span>Dashboards</span>
                        <i class="fas fa-caret-down"></i>
                    </div>
                    <div class="nav-item">
                        <span>Reports</span>
                        <i class="fas fa-caret-down"></i>
                    </div>
                    <div class="nav-item">
                        <span>Communications</span>
                        <i class="fas fa-caret-down"></i>
                    </div>
                    <button class="nav-grid-btn">
                        <i class="fas fa-th"></i>
                    </button>
                </nav>
                <div class="left-actions">
                    <div class="search-section">
                        <div class="search-container">
                            <input type="text" class="search-input" placeholder="Search...">
                            <button class="search-btn">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                    </div>
                    <button class="add-new-btn">
                        <span>Add New</span>
                        <i class="fas fa-caret-down"></i>
                    </button>
                    <button class="action-btn calendar-btn">
                        <i class="fas fa-calendar-alt"></i>
                    </button>
                    <button class="action-btn calculator-btn">
                        <i class="fas fa-calculator"></i>
                    </button>
                </div>
            </div>
            
            <div class="header-actions">
                <button class="action-btn star-btn">
                    <i class="fas fa-star"></i>
                </button>
                <button class="action-btn help-btn">
                    <i class="fas fa-question-circle"></i>
                </button>
                <button class="action-btn notification-btn">
                    <span class="notification-count">0</span>
                </button>
                <button class="action-btn settings-btn">
                    <i class="fas fa-cog"></i>
                </button>
                <div class="user-profile">
                    <div class="user-avatar">ND</div>
                </div>
            </div>
        </div>
    </header>

    <!-- Breadcrumb -->
    <div class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="#">Home</a> <span class="breadcrumb-separator">/</span> <a href="#">Search</a> <span class="breadcrumb-separator">/</span> <a href="#">Melinda Michaels</a> <span class="breadcrumb-separator">/</span> Cityview Towers
        </div>
        <i class="fas fa-info-circle info-icon"></i>
    </div>

    <!-- Page Header -->
    <div class="page-header">
        <div class="page-title">
            <div class="title-section">
                <div class="title-with-badges">
                    <h1>Melinda Michaels</h1>
                    <div class="badges-container">
                        <span class="resident-badge current">Current</span>
                        <span class="resident-badge primary">Primary</span>
                    </div>
                </div>
                <div class="page-meta">
                    Cityview Towers • Unit 288 • t0039661</a>
                </div>
            </div>
        </div>
        <!--<div class="middle-actions">
            <div class="header-separator"></div>
            <div class="resident-actions">
                <button class="resident-action-btn email" title="Send Email">
                    <i class="fas fa-envelope"></i>
                </button>
                <button class="resident-action-btn call" title="Call">
                    <i class="fas fa-phone"></i>
                </button>
                <button class="resident-action-btn sms" title="Send SMS">
                    <i class="fas fa-mobile-alt"></i>
                </button>
            </div>
        </div>-->
        <div class="resident-kebab-menu">
            <button class="resident-kebab-btn">
                <i class="fas fa-ellipsis-v"></i>
            </button>
            <div class="resident-kebab-dropdown">
                <!-- Financial Actions -->
                <div class="resident-kebab-group-header">Financial</div>
                <div class="resident-kebab-option" data-action="add-charge">
                    <i class="fas fa-circle-plus"></i>
                    <span>Add charge</span>
                </div>
                <div class="resident-kebab-option" data-action="receive">
                    <i class="fas fa-credit-card"></i>
                    <span>Receive payment</span>
                </div>
                
                <!-- Service Actions -->
                <div class="resident-kebab-separator"></div>
                <div class="resident-kebab-group-header">Service</div>
				<div class="resident-kebab-option" data-action="add-maintenance">
                    <i class="fas fa-wrench"></i>
                    <span>Add work order</span>
                </div>
                
                <!-- Other Actions -->
                <div class="resident-kebab-separator"></div>
                <div class="resident-kebab-group-header">Other</div>
                <div class="resident-kebab-option" data-action="add-activity">
                    <i class="fas fa-plus-circle"></i>
                    <span>Add activity</span>
                </div>
                <div class="resident-kebab-option" data-action="change-linked-customer">
                    <i class="fas fa-link"></i>
                    <span>Change linked customer</span>
                </div>
                <div class="resident-kebab-option" data-action="prorate-calculator">
                    <i class="fas fa-calculator"></i>
                    <span>Prorate calculator</span>
                </div>
                </div> 
        </div>
    </div>



    <div class="main-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-menu">
                <div class="menu-section">
                    <div class="menu-item active" id="overview-menu" onclick="toggleView('overview')">
						<i class="fas fa-home text-gray-500 mr-2"></i>
						Overview
                </div>
                    </div>
                                 <div class="">
					<div class="menu-item">
						<i class="fas fa-wrench text-gray-500 mr-2"></i>
						Work orders
                        <span class="menu-count">1</span>
                    </div>
                     <div class="menu-item">
						<i class="fas fa-file-contract text-gray-500 mr-2"></i>
						Lease information
                </div>
                     <div class="menu-item">
						<i class="fas fa-shield-alt text-gray-500 mr-2"></i>
						Renters insurance
                    </div>
					<div class="menu-item" id="ledger-menu" onclick="toggleView('ledger')">
						<i class="fas fa-receipt text-gray-500 mr-2"></i>
						Ledger
                    </div>
                     <div class="menu-item">
						<i class="fas fa-university text-gray-500 mr-2"></i>
						Bank accounts
                    </div>
                     <div class="menu-item">
						<i class="fas fa-boxes text-gray-500 mr-2"></i>
						Rentable items
                </div>
					<div class="menu-item">
						<i class="fas fa-folder text-gray-500 mr-2"></i>
						Documents
                </div>
					<div class="menu-item">
						<i class="fas fa-concierge-bell text-gray-500 mr-2"></i>
                        Concierge
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="content-area">
            <!-- Overview View -->
            <div id="overview-view" class="container py-6 mx-auto">

            <!-- Two Column Layout: 2/3 and 1/3 -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                
                <!-- First Column (2/3 width) -->
                <div class="col-span-1 lg:col-span-2 space-y-6">
                    
                    <!-- Row 1: Active Tasks & Alerts -->
                    <div class="card hover-lift shadow-soft card-enhanced-shadow">
                        <div class="card-header" id="alerts-header" onclick="toggleAlerts()" style="cursor: pointer;">
                            <div class="flex items-center justify-between w-full">
                                <div class="flex-1">
                                    <h3 class="card-title flex items-center gap-2">
                                        <i class="fas fa-exclamation-circle text-orange-500 text-sm"></i>
                                        Active Tasks & Alerts
                                    </h3>
                                    <div class="mt-1 flex items-center gap-4 text-xs text-gray-600" id="alerts-summary">
                                        <span class="flex items-center gap-1">
                                            <i class="fas fa-calendar-times text-red-500"></i>
                                            Lease expires Sep 30
                                        </span>
                                        <span class="flex items-center gap-1">
                                            <i class="fas fa-wrench text-yellow-500"></i>
                                            Work order pending
                                        </span>
                                        <span class="flex items-center gap-1">
                                            <i class="fas fa-user-plus text-orange-500"></i>
                                            Application review
                                        </span>
                    </div>
                    </div>
                                <div class="flex items-center gap-2">
                                    <span class="text-xs bg-orange-100 text-gray-900 px-2 py-1 rounded-full font-medium">3 items</span>
                                    <i id="alerts-chevron" class="fas fa-chevron-down text-gray-400 text-sm transition-transform duration-200"></i>
                </div>
                    </div>
                        </div>
                        <div class="card-content" id="alerts-content" style="display: none;">
                            <div class="space-y-3">
                                <!-- Lease Expiring -->
                                <div class="task-item p-3 border border-gray-200 rounded-lg">
                                    <div class="flex items-start gap-3">
                                        <div class="w-2 h-2 bg-red-500 rounded-full mt-2 flex-shrink-0"></div>
                                        <div class="flex-1">
                                            <div class="flex items-center justify-between mb-1">
                                                <h4 class="text-sm font-semibold">Lease Expiring Soon</h4>
                                                <button class="text-xs bg-primary text-white px-3 py-1 rounded-lg transition-colors">
                                                    Create proposal
                                                </button>
                                            </div>
                                            <p class="text-xs">Current lease expires Sep 30, 2025 - renewal action required</p>
                                        </div>
                                    </div>
                                </div>

                                <!-- Open Work Order -->
                                <div class="task-item p-3 border border-gray-200 rounded-lg">
                                    <div class="flex items-start gap-3">
                                        <div class="w-2 h-2 bg-yellow-500 rounded-full mt-2 flex-shrink-0"></div>
                                        <div class="flex-1">
                                            <div class="flex items-center justify-between mb-1">
                                                <h4 class="text-sm font-semibold">Open Work Order</h4>
                                                <div class="flex items-center gap-2">
                                                    <button class="text-xs bg-gray-100 hover:bg-gray-200 px-3 py-1 rounded-lg transition-colors">
                                                        View Details
                                                    </button>
                                                    <button class="text-xs bg-primary text-white px-3 py-1 rounded-lg transition-colors">
                                                        Complete
                                                    </button>
                                                </div>
                                            </div>
                                            <p class="text-xs">Work Order #26145: Refrigerator is not working (Appliances) - Medium Priority</p>
                                        </div>
                                    </div>
                                </div>

                                <!-- Action Required -->
                                <div class="task-item p-3 bg-gray-50 border border-gray-200 rounded-lg">
                                    <div class="flex items-start gap-3">
                                        <div class="w-2 h-2 bg-orange-500 rounded-full mt-2 flex-shrink-0"></div>
                                        <div class="flex-1">
                                            <div class="flex items-center justify-between mb-1">
                                                <h4 class="text-sm font-semibold">Roommate Application Pending</h4>
                                                <div class="flex items-center gap-2">
                                                    <button class="bg-gray-200 hover:bg-gray-300 text-xs px-3 py-1 rounded-lg transition-colors">
                                                        Send invitation
                                                    </button>
                                                    <button class="bg-primary text-xs text-white px-3 py-1 rounded-lg transition-colors">
                                                        Approve application
                                                    </button>
                                                </div>
                                            </div>
                                            <p class="text-xs">Angela Johnson's application completed - requires approval</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Row 2: Two Stat Cards Side by Side -->
                    <div class="grid grid-cols-2 gap-6">
                        <!-- Outstanding Balance Stat Card -->
                        <div class="stat-card hover-lift cursor-pointer bg-white border border-gray-200 rounded-lg p-4 shadow-sm border-l-4 border-l-red-500" data-pageslide="outstanding-balance">
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 bg-red-50 rounded-lg flex items-center justify-center flex-shrink-0">
                                    <i class="fas fa-exclamation-triangle text-red-500 text-sm"></i>
                            </div>
                                <div class="flex-1">
                                    <div class="mb-1">
                                        <span class="stat-value text-2xl font-bold text-gray-900">$2,674.50</span>
                            </div>
                                    <div class="mb-1">
                                        <span class="stat-label text-sm text-gray-800">Outstanding balance</span>
                                    </div>
                                    <div class="flex items-center gap-1 text-xs">
                                        <span class="text-red-600 font-medium">2 past due</span>
                                        <span class="text-gray-400">•</span>
                                        <span class="text-gray-600">2 current</span>
                                        <span class="text-gray-400">•</span>
                                        <span class="text-orange-600">1 pending payment</span>
                            </div>
                        </div>
                    </div>
                    </div>

                        <!-- Health Score Stat Card -->
                        <div class="stat-card hover-lift cursor-pointer bg-white border border-gray-200 rounded-lg p-4 shadow-sm border-l-4 border-l-green-500" data-pageslide="health-score">
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 bg-green-50 rounded-lg flex items-center justify-center flex-shrink-0">
                                    <i class="fas fa-chart-line text-green-500 text-sm"></i>
                                </div>
                                <div class="flex-1">
                                    <div class="mb-1">
                                        <span class="stat-value text-2xl font-bold text-gray-900">85</span>
                                    </div>
                                    <div class="mb-1">
                                        <span class="stat-label text-sm text-gray-800">Health score</span>
                                    </div>
                                    <div class="flex items-center gap-1 text-xs">
                                        <span class="text-gray-600">Good tenant</span>
                                        <span class="text-gray-400">•</span>
                                        <span class="text-gray-600">Low risk</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Row 3: Two Columns - Resident Info + Lease Info -->
                    <div class="grid grid-cols-2 gap-6" id="two-column-layout">
                        <!-- Column 1: Resident Information + Notes -->
                        <div class="flex flex-col space-y-6" id="column-1-resident-notes">

                    <!-- Resident Information Card -->
                    <div class="card hover-lift shadow-soft card-shadow-static">
                        <div class="card-header">
                            <div class="flex items-center justify-between w-full">
                                <h3 class="card-title">Resident information</h3>
                                <div class="flex items-center gap-2">
                                    <button class="section-edit-btn btn btn-sm text-sm px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700  focus-ring rounded-lg">
                                        <i class="fas fa-pen text-sm mr-1.5"></i>
                                        Edit
                                    </button>
                                    <button id="kebab-btn-resident" class="kebab-btn btn btn-sm px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700  focus-ring w-10 h-8 flex items-center justify-center rounded-lg">
                                        <i class="fas fa-ellipsis-v text-sm"></i>
                        </button>
                    </div>
                    </div>
                        </div>
                        <div class="card-content">
                            <div class="flex items-start gap-3">
                                <!-- Avatar -->
                                <div class="w-10 h-10 bg-orange-500 rounded-full flex items-center justify-center flex-shrink-0">
                                    <span class="text-white font-semibold text-sm">MM</span>
                            </div>

                                <!-- Resident Info -->
                                <div class="flex-1 min-w-0">
                                    <h4 class="font-semibold text-gray-900 mb-1">Melinda Michaels <i class="fas fa-clone text-primary text-xs cursor-pointer ml-1" title="Copy resident name, email and phone number"></i></h4>
                                    <p class="text-sm text-gray-600 mb-2">Preferred name: Mel Michaels</p>
                                    
                                    <!-- Contact Information -->
                                    <div class="space-y-1 text-sm mb-2">
                                        <div class="flex items-center gap-2">
                                            <span class="text-gray-900">(555) 123-4567</span>
                                            <i class="fas fa-phone text-link text-sm cursor-pointer" title="Call"></i>
                                            <i class="fas fa-mobile-alt text-link text-sm cursor-pointer" title="Mobile"></i>
                            </div>
                                        <div class="flex items-center gap-2">
                                            <span class="text-gray-900">melinda.michaels@email.com</span>
                                            <i class="fas fa-envelope text-link text-sm cursor-pointer" title="Send email"></i>
                            </div>
                            </div>
                                    
                                    <div class="text-xs">
                                        <span class="text-gray-500">Preferred contact: </span>
                                        <span class="text-gray-900 font-medium">SMS</span>
                            </div>
                            </div>
                            </div>
                            
                            <!-- RentCafe Registration Section -->
                            <div class="mt-6 pt-6 border-t border-gray-100">
                                <div class="flex items-center justify-between mb-1">
                                    <span class="text-sm font-medium text-gray-700">RentCafe Registration</span>
                                    <div class="flex items-center space-x-2">
                                        <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                        <span class="text-xs font-medium text-green-700" data-field="rentcafe-status">Registered</span>
                            </div>
                            </div>
                                <div class="flex items-center justify-between">
                                    <p class="text-xs text-gray-500" data-field="rentcafe-date">Registered on March 15, 2023</p>
                                    <span class="text-primary text-xs cursor-pointer hover:text-primary/80 transition-colors">
                                        Preview account
                                        <i class="fas fa-external-link-alt text-xs ml-1"></i>
                                    </span>
                        </div>
                    </div>
                    
                    <!-- Roommates Section -->
                    <div class="mt-6 pt-6 border-t border-gray-100">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-2">
                                <i class="fas fa-users text-gray-500 text-sm"></i>
                                <span class="text-sm font-medium">2 roommates (1 current, <span class="text-orange-600">1 pending</span>)</span>
                            </div>
                            <span class="text-link text-sm cursor-pointer transition-colors" onclick="openPageslide('roommate-details-overlay')">View details</span>
                        </div>
                    </div>

                    </div>
                    </div>

                    <!-- Notes Card -->
                    <div class="card hover-lift shadow-soft card-shadow-static">
                        <div class="card-header">
                            <div class="flex items-center justify-between w-full">
                                <h3 class="card-title">Notes</h3>
                                <button class="btn btn-sm text-sm px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 focus-ring rounded-lg font-bold" onclick="addNote()">
                                    <i class="fas fa-circle-plus text-sm mr-1.5"></i>
                                    Add
                                </button>
                            </div>
                        </div>
                        <div class="card-content">
                            <!-- Note Entry -->
                            <div class="note-entry">
                                <div class="note-header mb-2">
                                    <div class="flex items-center gap-2 text-sm">
                                        <span class="font-semibold text-gray-900">Sarah Chen</span>
                                        <span class="text-gray-500">•</span>
                                        <span class="text-gray-500">Aug 16, 2025 at 2:45 pm</span>
                            </div>
                            </div>
                                <div class="note-content mb-3">
                                    <p class="text-sm text-gray-700">
                                        <span id="note-preview">Received work order for refrigerator repair. Tenant mentioned it stopped cooling yesterday evening.</span>
                                        <span id="note-full" class="hidden"> Scheduled technician for tomorrow morning. Also discussed upcoming lease renewal - tenant interested in staying for another year.</span>
                                        <button id="note-toggle" class="text-link font-medium ml-1" onclick="toggleNoteExpansion()">read more</button>
                                    </p>
                            </div>
                            </div>
                            
                            <!-- View More Notes -->
                            <div class="mt-3">
                                <button class="text-sm text-link font-medium" onclick="viewAllNotes()">
                                    See 4 other notes
                                </button>
                            </div>
                            </div>
                        </div>
                        
                        </div>
                        
                        <!-- Column 2: Lease Information -->
                        <div class="flex flex-col space-y-6" id="column-2-lease-info">
                            <!-- Lease Information Card -->
                    <div class="card hover-lift shadow-soft flex-grow card-shadow-static">
                        <div class="card-header">
                            <div class="flex items-center justify-between w-full">
                                <h3 class="card-title">Lease information</h3>
                                <div class="flex items-center gap-2">
                                    <button id="kebab-btn-lease" class="kebab-btn btn btn-sm px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 focus-ring h-8 flex items-center justify-center rounded-lg gap-2">
                                        <span class="text-sm font-medium">Manage</span>
                                        <i class="fas fa-chevron-down text-xs"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        <div class="card-content">
                            <div class="space-y-12">
                                
                                <!-- LEASE OVERVIEW Section -->
                                <div class="lease-section">
                                    <div class="lease-section-header">
                                        <h4 class="text-sm font-semibold text-gray-500 uppercase tracking-wide">Lease overview</h4>
                        </div>
                                    <div class="lease-section-content">
                                        <div class="lease-overview-grid">
                                            <div class="lease-overview-item">
                                                <div class="flex items-center gap-2 mb-1">
                                                    <i class="fas fa-calendar text-gray-500 text-sm"></i>
                                                    <span class="text-sm font-medium text-gray-900">Oct 1, 2024 - Sep 30, 2025</span>
                                                    <span class="badge bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded-full font-medium">12 months</span>
                                </div>
                                                <div class="flex items-center gap-3 mt-2">
                                                    <div class="flex items-center gap-1">
                                                        <span class="text-sm font-medium">$2000/mo rent</span>
                            </div>
                                                    <span class="text-gray-300">•</span>
                                                    <div class="flex items-center gap-1">
                                                        <span class="text-sm font-medium">$1850 deposit</span>
                                                    </div>
													<span class="text-gray-300">•</span>
                                                    <div class="flex items-center gap-1">
                                                        <span class="text-sm font-medium">late fees: 0/0</span>
                                                    </div>
                                                </div>
                                                <div class="flex items-center gap-2 mt-2">
                                                    <div class="lease-status-indicator active"></div>
                                                    <span class="text-sm text-green-700 font-medium">Active lease</span>
                                                    <span class="text-gray-300">•</span>
                                                    <span class="text-sm">Move-in: Oct 2, 2025</span>
                                                </div>
                                            </div>
                                        </div>
                        </div>
                    </div>

                                <!-- PROPERTY DETAILS Section -->
                                <div class="lease-section">
                                    <div class="lease-section-header">
                                        <h4 class="text-sm font-semibold text-gray-500 uppercase tracking-wide">Unit details</h4>
                                    </div>
                                    <div class="lease-section-content">
                                        <div class="property-details-grid">
                                            <div class="property-detail-item">
                                                <div class="flex items-center gap-2 mb-2">
                                                    <i class="fas fa-bed text-gray-500 text-sm"></i>
                                                    <span class="text-sm font-medium text-gray-900">3 bed 2 bath</span>
                                                    <span class="text-gray-300">•</span>
                                                    <span class="text-sm font-medium text-gray-900">950 ft²</span>
													<span class="text-gray-300">•</span>
                                                    <span class="text-sm text-gray-700">unit type: iq01_3b2</span>
													
                                </div>
                                                <div class="flex items-start gap-2">
                                                    <i class="fas fa-map-marker-alt text-gray-500 text-sm mt-0.5"></i>
                                                    <div class="text-sm text-gray-700">
                                                        <div class="font-medium mb-1">430 S Fairview Avenue 288</div>
                                                        <div class="font-medium">Santa Barbara, CA 93117</div>
                            </div>
                        </div>
                                </div>
                            </div>
                        </div>
                    </div>

                                <!-- ADDITIONAL INFO Section -->
                                <div class="lease-section">
                                    <div class="lease-section-header">
                                        <h4 class="text-sm font-semibold text-gray-500 uppercase tracking-wide">Additional info</h4>
                                    </div>
                                    <div class="lease-section-content">
                                        <div class="additional-info-grid">
                                            <div class="flex items-center justify-between">
                                                <div class="flex items-center gap-2">
                                                    <i class="fas fa-paw text-gray-500 text-sm"></i>
                                                    <span class="text-sm font-medium">2 Pets (1 dog, 1 cat)</span>
                                </div>
                                                <span class="text-link text-sm cursor-pointer  transition-colors" onclick="openPageslide('pet-details-overlay')">View details</span>
                            </div>
                                            <div class="flex items-center justify-between">
                                                <div class="flex items-center gap-2">
                                                    <i class="fas fa-car text-gray-500 text-sm"></i>
                                                    <span class="text-sm font-medium">2 Vehicles</span>
                        </div>
                                                <span class="text-link text-sm cursor-pointer transition-colors" onclick="openPageslide('vehicle-details-overlay')">View details</span>
                                </div>
                            </div>
                        </div>
                    </div>
                        </div>
                    </div>
                        </div>
                    </div>
                </div>
                </div>
                <!-- Second Column (1/3 width) -->
                <div class="col-span-1 lg:col-span-1 space-y-6 bg-gray-100 ml-6 p-6 rounded-lg">

                    <!-- Activities Card -->
                    <div class="card hover-lift shadow-soft" id="activity-timeline-card">
                        <div class="card-header">
                            <div class="flex items-center justify-between w-full">
                                <h3 class="card-title">
                                    Activity Timeline
                                </h3>
                                <div class="relative">
                                    <button id="activity-add-btn" class="btn btn-sm text-sm px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 focus-ring rounded-lg font-bold" onclick="toggleActivityAddMenu()">
                                        <i class="fas fa-circle-plus text-sm mr-1.5"></i>
                                        Add
                                        <i class="fas fa-chevron-down text-xs ml-1"></i>
                                    </button>
                                    <div id="activity-add-menu" class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-50 hidden">
                                        <div class="py-1">
                                            <button class="activity-add-option w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors" onclick="addActivityType('comment')">
                                                <i class="fas fa-comment mr-2 text-gray-500"></i>
                                                Add comment
                                            </button>
                                            <button class="activity-add-option w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors" onclick="addActivityType('follow-up')">
                                                <i class="fas fa-clock mr-2 text-gray-500"></i>
                                                Add follow-up
                                            </button>
                                            <button class="activity-add-option w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors" onclick="addActivityType('appointment')">
                                                <i class="fas fa-calendar-check mr-2 text-gray-500"></i>
                                                Add appointment
                                            </button>
                                            <button class="activity-add-option w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors" onclick="addActivityType('log')">
                                                <i class="fas fa-clipboard-list mr-2 text-gray-500"></i>
                                                Log activity
                                            </button>
                                            <button class="activity-add-option w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors" onclick="addActivityType('memo')">
                                                <i class="fas fa-sticky-note mr-2 text-gray-500"></i>
                                                Add memo
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                    </div>
                                </div>
                        <div class="card-content">
                            <!-- Activity Filters -->
                            <div class="activity-filters">
                                <div class="flex items-center gap-4">
                                    <select id="activity-filter" class="filter-dropdown w-full" onchange="filterActivities(this.value)">
                                        <option value="all">All Activities</option>
                                        <option value="communications">Communications</option>
                                        <option value="work-orders">Work Orders</option>
                                        <option value="payments">Payments</option>
                                        <option value="lease">Lease</option>
                                    </select>
                            </div>
                        </div>
                            
                            <div class="space-y-4" id="activity-timeline-container">
                                <!-- Today's Activities -->
                                <div class="activity-section">
                                    <div class="activity-date-header">
                                        <i class="fas fa-circle text-primary text-xs mr-2"></i>
                                        <span class="text-sm font-semibold text-gray-900">Today: Aug 17, 2025</span>
                                </div>

                                    <!-- Text Message -->
                                    <div class="activity-item" data-filter="communications work-orders" data-time="recent">
                                        <div class="activity-icon bg-primary-light">
                                            <i class="fas fa-sms text-primary text-sm"></i>
                            </div>
                                        <div class="activity-content">
                                            <div class="activity-header">
                                                <span class="activity-type">Text: Sent</span>
                                                <span class="activity-time">6:07 AM PST</span>
                                            </div>
                                            <p class="activity-description">Work order update: Technician scheduled for refrigerator repair</p>
                                            <div class="activity-meta">
                                                <span class="text-xs text-gray-500">via Chat IQ</span>
                                            </div>
                        </div>
                    </div>

                                    <!-- Email -->
                                    <div class="activity-item" data-filter="communications payments" data-time="recent">
                                        <div class="activity-icon bg-primary-light">
                                            <i class="fas fa-envelope text-primary text-sm"></i>
                                        </div>
                                        <div class="activity-content">
                                            <div class="activity-header">
                                                <span class="activity-type">Email: Sent</span>
                                                <span class="activity-time">6:07 AM PST</span>
                                            </div>
                                            <p class="activity-description">Subject: Payment Received - Account Balance Update</p>
                                            <div class="activity-meta">
                                                <span class="text-xs text-gray-500">via Chat IQ</span>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Follow-up -->
                                    <div class="activity-item" data-filter="communications lease" data-time="recent">
                                        <div class="activity-icon bg-primary-light">
                                            <i class="fas fa-user-clock text-primary text-sm"></i>
                                        </div>
                                        <div class="activity-content">
                                            <div class="activity-header">
                                                <span class="activity-type">Follow-Up - Created</span>
                                                <span class="activity-time">6:07 AM PST</span>
                                            </div>
                                            <p class="activity-description">Created follow up for lease renewal discussion</p>
                                            <div class="activity-meta">
                                                <span class="text-xs text-gray-500">System Generated</span>
                                            </div>
                                        </div>
                                    </div>
                </div>

                                <!-- Recent Activities -->
                                <div class="activity-section">
                                    <div class="activity-date-header">
                                        <i class="fas fa-circle text-gray-300 text-xs mr-2"></i>
                                        <span class="text-sm font-semibold text-gray-700">Aug 16, 2025</span>
                                    </div>
                                    
                                    <!-- Email -->
                                    <div class="activity-item" data-filter="communications payments" data-time="recent">
                                        <div class="activity-icon bg-primary-light">
                                            <i class="fas fa-envelope text-primary text-sm"></i>
                                        </div>
                                        <div class="activity-content">
                                            <div class="activity-header">
                                                <span class="activity-type">Email: Sent</span>
                                                <span class="activity-time">2:08 PM PST</span>
                                            </div>
                                            <p class="activity-description">Subject: Important: Payment Due Reminder</p>
                                            <div class="activity-meta">
                                                <span class="text-xs text-gray-500">via CRM Generated</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Work Order -->
                                    <div class="activity-item" data-filter="work-orders" data-time="recent">
                                        <div class="activity-icon bg-primary-light">
                                            <i class="fas fa-wrench text-primary text-sm"></i>
                                        </div>
                                        <div class="activity-content">
                                            <div class="activity-header">
                                                <span class="activity-type">Work Order: Created</span>
                                                <span class="activity-time">10:15 AM PST</span>
                                            </div>
                                            <p class="activity-description">WO #26145: Refrigerator is not working (Appliances)</p>
                                            <div class="activity-meta">
                                                <span class="text-xs text-gray-500">Medium Priority • by Melinda Michaels</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Load More Section -->
                                <div class="load-more-section text-center py-4" id="load-more-section">
                                    <button class="btn text-sm px-4 py-2 bg-gray-100 hover:bg-gray-200 focus-ring rounded-lg" onclick="loadMoreActivities()">
                                        <i class="fas fa-chevron-down text-sm mr-2"></i>
                                        Load more activities
                                    </button>
                                </div>
                                
                                <!-- Hidden Activities (Initially hidden) -->
                                <div id="hidden-activities" class="hidden">
                                
                                <!-- Oct 1, 2024 - Lease Renewal -->
                                <div class="activity-section">
                                    <div class="activity-date-header">
                                        <i class="fas fa-circle text-gray-300 text-xs mr-2"></i>
                                        <span class="text-sm font-semibold text-gray-700">Oct 1, 2024</span>
                                    </div>
                                    
                                    <!-- Lease Renewal #4 Milestone -->
                                    <div class="activity-item milestone-item" data-filter="milestones lease" data-time="1year">
                                        <div class="activity-icon bg-primary-light">
                                            <i class="fas fa-key text-primary text-sm"></i>
                                        </div>
                                        <div class="activity-content">
                                            <div class="activity-header">
                                                <span class="activity-type font-semibold">Lease Renewal #4</span>
                                                <span class="activity-time">Oct 1, 2024</span>
                                            </div>
                                            <p class="activity-description">Renewed lease for 12-month term through Sep 30, 2025</p>
                                            <div class="activity-meta">
                                                <span class="text-xs text-gray-900 font-medium">✓ Active Lease</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Oct 1, 2023 - Previous Lease Renewal -->
                                <div class="activity-section">
                                    <div class="activity-date-header">
                                        <i class="fas fa-circle text-gray-300 text-xs mr-2"></i>
                                        <span class="text-sm font-semibold text-gray-700">Oct 1, 2023</span>
                                    </div>
                                    
                                    <!-- Lease Renewal #3 Milestone -->
                                    <div class="activity-item milestone-item" data-filter="milestones lease" data-time="1year">
                                        <div class="activity-icon bg-primary-light">
                                            <i class="fas fa-sync text-primary text-sm"></i>
                                        </div>
                                        <div class="activity-content">
                                            <div class="activity-header">
                                                <span class="activity-type font-semibold">Lease Renewal #3</span>
                                                <span class="activity-time">Oct 1, 2023</span>
                                            </div>
                                            <p class="activity-description">Renewed lease for 12-month term</p>
                                            <div class="activity-meta">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Jul 15, 2022 - Regular Activity Example -->
                                <div class="activity-section">
                                    <div class="activity-date-header">
                                        <i class="fas fa-circle text-gray-300 text-xs mr-2"></i>
                                        <span class="text-sm font-semibold text-gray-700">Jul 15, 2022</span>
                                    </div>
                                    
                                    <!-- Payment Received -->
                                    <div class="activity-item" data-filter="communications payments" data-time="all">
                                        <div class="activity-icon bg-primary-light">
                                            <i class="fas fa-dollar-sign text-primary text-sm"></i>
                                        </div>
                                        <div class="activity-content">
                                            <div class="activity-header">
                                                <span class="activity-type">Payment Received</span>
                                                <span class="activity-time">9:30 AM PST</span>
                                            </div>
                                            <p class="activity-description">Rent payment for July 2022 - $2,000.00</p>
                                            <div class="activity-meta">
                                                <span class="text-xs text-gray-500">ACH Transfer • On time</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Mar 10, 2021 - Regular Activity Example -->
                                <div class="activity-section">
                                    <div class="activity-date-header">
                                        <i class="fas fa-circle text-gray-300 text-xs mr-2"></i>
                                        <span class="text-sm font-semibold text-gray-700">Mar 10, 2021</span>
                                    </div>
                                    
                                    <!-- Work Order Completed -->
                                    <div class="activity-item" data-filter="work-orders" data-time="all">
                                        <div class="activity-icon bg-primary-light">
                                            <i class="fas fa-check text-primary text-sm"></i>
                                        </div>
                                        <div class="activity-content">
                                            <div class="activity-header">
                                                <span class="activity-type">Work Order: Completed</span>
                                                <span class="activity-time">2:45 PM PST</span>
                                            </div>
                                            <p class="activity-description">WO #18392: Kitchen faucet repair completed</p>
                                            <div class="activity-meta">
                                                <span class="text-xs text-gray-500">Maintenance Team • Satisfied</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Oct 2, 2020 - Move-in -->
                                <div class="activity-section">
                                    <div class="activity-date-header">
                                        <i class="fas fa-circle text-gray-300 text-xs mr-2"></i>
                                        <span class="text-sm font-semibold text-gray-700">Oct 2, 2020</span>
                                    </div>
                                    
                                    <!-- Move-in Milestone -->
                                    <div class="activity-item milestone-item" data-filter="milestones lease" data-time="all">
                                        <div class="activity-icon bg-primary-light">
                                            <i class="fas fa-home text-primary text-sm"></i>
                                        </div>
                                        <div class="activity-content">
                                            <div class="activity-header">
                                                <span class="activity-type font-semibold">Move-in Date</span>
                                                <span class="activity-time">Oct 2, 2020</span>
                                            </div>
                                            <p class="activity-description">Initial move-in to Unit 288 at Cityview Towers</p>
                                            <div class="activity-meta">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Sep 15, 2020 - Lease Signing -->
                                <div class="activity-section">
                                    <div class="activity-date-header">
                                        <i class="fas fa-circle text-gray-300 text-xs mr-2"></i>
                                        <span class="text-sm font-semibold text-gray-700">Sep 15, 2020</span>
                                    </div>
                                    
                                    <!-- Lease Signing Milestone -->
                                    <div class="activity-item milestone-item" data-filter="milestones lease" data-time="all">
                                        <div class="activity-icon bg-primary-light">
                                            <i class="fas fa-file-signature text-primary text-sm"></i>
                                        </div>
                                        <div class="activity-content">
                                            <div class="activity-header">
                                                <span class="activity-type font-semibold">Lease Signed</span>
                                                <span class="activity-time">Sep 15, 2020</span>
                                            </div>
                                            <p class="activity-description">Initial lease agreement signed for 12-month term</p>
                                            <div class="activity-meta">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Sep 10, 2020 - Application Approved -->
                                <div class="activity-section">
                                    <div class="activity-date-header">
                                        <i class="fas fa-circle text-gray-300 text-xs mr-2"></i>
                                        <span class="text-sm font-semibold text-gray-700">Sep 10, 2020</span>
                                    </div>
                                    
                                    <!-- Application Approved Milestone -->
                                    <div class="activity-item milestone-item" data-filter="milestones lease" data-time="all">
                                        <div class="activity-icon bg-primary-light">
                                            <i class="fas fa-check-circle text-primary text-sm"></i>
                                        </div>
                                        <div class="activity-content">
                                            <div class="activity-header">
                                                <span class="activity-type font-semibold">Application Approved</span>
                                                <span class="activity-time">Sep 10, 2020</span>
                                            </div>
                                            <p class="activity-description">Rental application approved after background and credit check</p>
                                            <div class="activity-meta">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Sep 5, 2020 - Application Submitted -->
                                <div class="activity-section">
                                    <div class="activity-date-header">
                                        <i class="fas fa-circle text-gray-300 text-xs mr-2"></i>
                                        <span class="text-sm font-semibold text-gray-700">Sep 5, 2020</span>
                                    </div>
                                    
                                    <!-- Application Submitted Milestone -->
                                    <div class="activity-item milestone-item" data-filter="milestones lease" data-time="all">
                                        <div class="activity-icon bg-primary-light">
                                            <i class="fas fa-file-alt text-primary text-sm"></i>
                                        </div>
                                        <div class="activity-content">
                                            <div class="activity-header">
                                                <span class="activity-type font-semibold">Application Submitted</span>
                                                <span class="activity-time">Sep 5, 2020</span>
                                            </div>
                                            <p class="activity-description">Initial rental application submitted for Unit 288</p>
                                            <div class="activity-meta">
                                                <span class="text-xs text-gray-500">Online application portal</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                </div> <!-- End hidden-activities -->
                                </div>
                            </div>
                        </div>
                                </div>
            </div>
        </div>

            <!-- Ledger View (Hidden by default) -->
            <div id="ledger-view" class="container py-6 mx-auto" style="display: none;">
                
                <!-- Page Title -->
                <div class="mb-6 flex items-center justify-between">
                    <h1 class="text-2xl font-semibold text-gray-900">Ledger</h1>
                    <div class="flex items-center gap-3">
                        <button class="px-4 py-2 bg-gray-200 hover:bg-gray-300 text-sm font-medium rounded-lg transition-colors">
                            <i class="fas fa-circle-plus mr-2"></i>
                            Add charge
                                        </button>
                        <button class="px-4 py-2 bg-gray-200 hover:bg-gray-300 text-sm font-medium rounded-lg transition-colors">
                            <i class="fas fa-credit-card mr-2"></i>
                            Receive payment
                                        </button>
                                    </div>
                                </div>

                        <!-- Account Summary Cards -->
            <div class="mb-8">
				<div class="grid grid-cols-1 md:grid-cols-5 gap-6">
					<div class="card card-shadow-static">
						<div class="card-content text-center">
							<div class="text-2xl font-bold text-gray-900">$2,674.50</div>
							<div class="text-sm text-gray-600">Outstanding balance</div>
						</div>
					</div>
					<div class="card card-shadow-static">
						<div class="card-content text-center">
							<div class="text-2xl font-bold text-gray-900">98% on-time</div>
							<div class="text-sm text-gray-600">Payment performance</div>
						</div>
					</div>
					<div class="card card-shadow-static">
						<div class="card-content text-center">
							<div class="text-2xl font-bold text-gray-900">Aug 16, 2025</div>
							<div class="text-sm text-gray-600">Last payment</div>
						</div>
					</div>
					<div class="card card-shadow-static">
						<div class="card-content text-center">
							<div class="text-2xl font-bold text-gray-900">3 days early</div>
							<div class="text-sm text-gray-600">Average payment time</div>
						</div>
					</div>
					<div class="card card-shadow-static">
						<div class="card-content text-center">
							<div class="text-2xl font-bold text-gray-900">Sep 1, 2025</div>
							<div class="text-sm text-gray-600">Next due date</div>
						</div>
					</div>
				</div>
            </div>



            <!-- Filters and Controls -->
            <div class="flex items-center justify-between gap-4 mb-6">
                <div class="flex items-center gap-4">
                    <!-- Search Box -->
                    <div class="flex-1 min-w-[300px]">
                        <div class="relative">
                            <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 text-sm"></i>
                            <input type="text" placeholder="Search transactions..." class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg text-sm focus-ring-primary">
                        </div>
                    </div>
                    
                    <!-- Tab-style Filters -->
                    <div class="flex items-center gap-2">
                        <button id="filter-all" class="tab-filter active px-4 py-2 rounded-full text-sm font-medium transition-colors" onclick="setExclusiveLedgerFilter('all')">
                            All
                        </button>
                        <button id="filter-unpaid" class="tab-filter px-4 py-2 rounded-full text-sm font-medium transition-colors" onclick="setExclusiveLedgerFilter('unpaid')">
                            Unpaid charges
                        </button>
                        <button id="filter-processing" class="tab-filter px-4 py-2 rounded-full text-sm font-medium transition-colors" onclick="setExclusiveLedgerFilter('processing')">
                            Processing payments
                        </button>
                    </div>
                </div>
                
                <!-- Kebab Menu -->
                <div class="relative">
                    <button id="ledger-kebab-btn" class="w-10 h-10 bg-gray-100 hover:bg-gray-200 text-gray-500 rounded-lg hover:text-gray-700 focus:outline-none flex items-center justify-center" onclick="toggleLedgerKebab()">
                        <i class="fas fa-ellipsis-v text-sm"></i>
                    </button>
                    <div id="ledger-kebab-menu" class="absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg border border-gray-200 z-50 hidden">
                        <div class="py-1">
                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" onclick="exportToExcel()">
                                <i class="fas fa-file-excel mr-2 text-gray-500"></i>
                                Export to Excel
                            </a>
                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" onclick="exportToPDF()">
                                <i class="fas fa-file-pdf mr-2 text-gray-500"></i>
                                Export to PDF
                            </a>
                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" onclick="emailReport()">
                                <i class="fas fa-envelope mr-2 text-gray-500"></i>
                                Email report
                            </a>
                            <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" onclick="printLedger()">
                                <i class="fas fa-print mr-2 text-gray-500"></i>
                                Print ledger
                            </a>
                        </div>
                    </div>
                </div>
                </div>

                        <!-- Ledger Table -->
            <div class="">
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50 border-b border-gray-200">
                            <tr>
                                <th class="px-6 py-3 text-left text-sm font-bold text-gray-600 tracking-wider cursor-pointer hover:bg-gray-100" onclick="sortTable('date')">
                                    <div class="flex items-center gap-2">
                                        Date
                                        <i class="fas fa-sort text-xs text-gray-400"></i>
                                    </div>
                                </th>
                                <th class="px-6 py-3 text-left text-sm font-bold text-gray-600 tracking-wider cursor-pointer hover:bg-gray-100" onclick="sortTable('description')">
                                    <div class="flex items-center gap-2">
                                        Description
                                        <i class="fas fa-sort text-xs text-gray-400"></i>
                                    </div>
                                </th>
                                <th class="px-6 py-3 text-center text-sm font-bold text-gray-600 tracking-wider cursor-pointer hover:bg-gray-100" onclick="sortTable('status')">
                                    <div class="flex items-center justify-center gap-2">
                                        Status
                                        <i class="fas fa-sort text-xs text-gray-400"></i>
                                    </div>
                                </th>
                                <th class="px-6 py-3 text-right text-sm font-bold text-gray-600 tracking-wider cursor-pointer hover:bg-gray-100" onclick="sortTable('charges')">
                                    <div class="flex items-center justify-end gap-2">
                                        Charges
                                        <i class="fas fa-sort text-xs text-gray-400"></i>
                                    </div>
                                </th>
                                <th class="px-6 py-3 text-right text-sm font-bold text-gray-600 tracking-wider cursor-pointer hover:bg-gray-100" onclick="sortTable('payments')">
                                    <div class="flex items-center justify-end gap-2">
                                        Payments
                                        <i class="fas fa-sort text-xs text-gray-400"></i>
                                    </div>
                                </th>
                                <th class="px-6 py-3 text-right text-sm font-bold text-gray-600 tracking-wider cursor-pointer hover:bg-gray-100" onclick="sortTable('balance')">
                                    <div class="flex items-center justify-end gap-2">
                                        Balance
                                        <i class="fas fa-sort text-xs text-gray-400"></i>
                                    </div>
                                </th>
                            </tr>
                        </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                <!-- Current Outstanding -->
                                <tr class="hover:bg-gray-50 table-row" data-page="1">
                                    <td class="px-6 py-4 text-sm text-gray-900">Aug 17, 2025</td>
                                    <td class="px-6 py-4">
                                        <div class="text-sm font-medium text-gray-900">Late Fee - Rent (July 2025)</div>
                                        <div class="text-xs text-gray-500">Applied after 5-day grace period • Code: latefee</div>
                                    </td>
                                    <td class="px-6 py-4 text-center">
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">Unpaid</span>
                                    </td>
                                    <td class="px-6 py-4 text-sm text-right font-medium text-gray-900">$75.00</td>
                                    <td class="px-6 py-4 text-sm text-right">-</td>
                                    <td class="px-6 py-4 text-sm text-right font-bold text-gray-900">$2,674.50</td>
                                </tr>
                                
                                <tr class="hover:bg-gray-50 table-row" data-page="1">
                                    <td class="px-6 py-4 text-sm text-gray-900">Aug 16, 2025</td>
                                    <td class="px-6 py-4">
                                        <div class="text-sm font-medium text-gray-900">ACH Payment - Partial</div>
                                        <div class="text-xs text-gray-500">Bank: Wells Fargo ***4521 • Code: achpay</div>
                                    </td>
                                    <td class="px-6 py-4 text-center">
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">Processing</span>
                                    </td>
                                    <td class="px-6 py-4 text-sm text-right">-</td>
                                    <td class="px-6 py-4 text-sm text-right font-medium text-gray-900">$1,337.25</td>
                                    <td class="px-6 py-4 text-sm text-right font-bold">$2,599.50</td>
                                </tr>

                                <tr class="hover:bg-gray-50 table-row" data-page="1">
                                    <td class="px-6 py-4 text-sm text-gray-900">Aug 1, 2025</td>
                                    <td class="px-6 py-4">
                                        <div class="text-sm font-medium text-gray-900">Rent (Residential) - August 2025</div>
                                        <div class="text-xs text-gray-500">Monthly rent charge • Code: rentres</div>
                                    </td>
                                    <td class="px-6 py-4 text-center">
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">Unpaid</span>
                                    </td>
                                    <td class="px-6 py-4 text-sm text-right font-medium text-gray-900">$2,000.00</td>
                                    <td class="px-6 py-4 text-sm text-right">-</td>
                                    <td class="px-6 py-4 text-sm text-right font-bold">$3,936.75</td>
                                </tr>

                                <tr class="hover:bg-gray-50 table-row" data-page="1">
                                    <td class="px-6 py-4 text-sm text-gray-900">Jul 6, 2025</td>
                                    <td class="px-6 py-4">
                                        <div class="text-sm font-medium text-gray-900">Late Fee - Rent (June 2025)</div>
                                        <div class="text-xs text-gray-500">Applied after 5-day grace period • Code: latefee</div>
                                    </td>
                                    <td class="px-6 py-4 text-center">
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">Unpaid</span>
                                    </td>
                                    <td class="px-6 py-4 text-sm text-right font-medium text-gray-900">$75.00</td>
                                    <td class="px-6 py-4 text-sm text-right">-</td>
                                    <td class="px-6 py-4 text-sm text-right font-bold text-gray-900">$1,936.75</td>
                                </tr>

                                <tr class="hover:bg-gray-50 table-row" data-page="1">
                                    <td class="px-6 py-4 text-sm text-gray-900">Jul 1, 2025</td>
                                    <td class="px-6 py-4">
                                        <div class="text-sm font-medium text-gray-900">Rent (Residential) - July 2025</div>
                                        <div class="text-xs text-gray-500">Monthly rent charge • Code: rentres</div>
                                    </td>
                                    <td class="px-6 py-4 text-center">
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">Unpaid</span>
                                    </td>
                                    <td class="px-6 py-4 text-sm text-right font-medium text-gray-900">$2,000.00</td>
                                    <td class="px-6 py-4 text-sm text-right">-</td>
                                    <td class="px-6 py-4 text-sm text-right font-bold text-gray-900">$1,861.75</td>
                                </tr>

                                <tr class="hover:bg-gray-50 table-row" data-page="1">
                                    <td class="px-6 py-4 text-sm text-gray-900">Jun 30, 2025</td>
                                    <td class="px-6 py-4">
                                        <div class="text-sm font-medium text-gray-900">ACH Payment - June Rent</div>
                                        <div class="text-xs text-gray-500">Bank: Wells Fargo ***4521 • Code: achpay</div>
                                    </td>
                                    <td class="px-6 py-4 text-center">
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">Paid</span>
                                    </td>
                                    <td class="px-6 py-4 text-sm text-right">-</td>
                                    <td class="px-6 py-4 text-sm text-right font-medium text-gray-900">$2,000.00</td>
                                    <td class="px-6 py-4 text-sm text-right font-bold">-$138.25</td>
                                </tr>

                                <tr class="hover:bg-gray-50 table-row" data-page="1">
                                    <td class="px-6 py-4 text-sm text-gray-900">Jun 15, 2025</td>
                                    <td class="px-6 py-4">
                                        <div class="text-sm font-medium text-gray-900">Pet Fee - Monthly (Luna & Whiskers)</div>
                                        <div class="text-xs text-gray-500">2 pets × $15/month • Code: petfee</div>
                                    </td>
                                    <td class="px-6 py-4 text-center">
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">Unpaid</span>
                                    </td>
                                    <td class="px-6 py-4 text-sm text-right font-medium text-gray-900">$30.00</td>
                                    <td class="px-6 py-4 text-sm text-right">-</td>
                                    <td class="px-6 py-4 text-sm text-right font-bold">$1,861.75</td>
                                </tr>

                                <tr class="hover:bg-gray-50 table-row" data-page="1">
                                    <td class="px-6 py-4 text-sm text-gray-900">Jun 1, 2025</td>
                                    <td class="px-6 py-4">
                                        <div class="text-sm font-medium text-gray-900">Rent (Residential) - June 2025</div>
                                        <div class="text-xs text-gray-500">Monthly rent charge • Code: rentres</div>
                                    </td>
                                    <td class="px-6 py-4 text-center">
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">Paid</span>
                                    </td>
                                    <td class="px-6 py-4 text-sm text-right font-medium text-gray-900">$2,000.00</td>
                                    <td class="px-6 py-4 text-sm text-right">-</td>
                                    <td class="px-6 py-4 text-sm text-right font-bold">$1,831.75</td>
                                </tr>

                                <tr class="hover:bg-gray-50 table-row hidden" data-page="2">
                                    <td class="px-6 py-4 text-sm text-gray-900">May 31, 2025</td>
                                    <td class="px-6 py-4">
                                        <div class="text-sm font-medium text-gray-900">ACH Payment - May Rent</div>
                                        <div class="text-xs text-gray-500">Bank: Wells Fargo ***4521 • Code: achpay</div>
                                    </td>
                                    <td class="px-6 py-4 text-center">
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">Paid</span>
                                    </td>
                                    <td class="px-6 py-4 text-sm text-right">-</td>
                                    <td class="px-6 py-4 text-sm text-right font-medium text-gray-900">$2,030.00</td>
                                    <td class="px-6 py-4 text-sm text-right font-bold">-$168.25</td>
                                </tr>

                                <tr class="hover:bg-gray-50 table-row" data-page="1">
                                    <td class="px-6 py-4 text-sm text-gray-900">May 15, 2025</td>
                                    <td class="px-6 py-4">
                                        <div class="text-sm font-medium text-gray-900">Pet Fee - Monthly (Luna & Whiskers)</div>
                                        <div class="text-xs text-gray-500">2 pets × $15/month • Code: petfee</div>
                                    </td>
                                    <td class="px-6 py-4 text-center">
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">Paid</span>
                                    </td>
                                    <td class="px-6 py-4 text-sm text-right font-medium text-gray-900">$30.00</td>
                                    <td class="px-6 py-4 text-sm text-right">-</td>
                                    <td class="px-6 py-4 text-sm text-right font-bold">$1,861.75</td>
                                </tr>

                                <tr class="hover:bg-gray-50 table-row hidden" data-page="2">
                                    <td class="px-6 py-4 text-sm text-gray-900">May 1, 2025</td>
                                    <td class="px-6 py-4">
                                        <div class="text-sm font-medium text-gray-900">Rent (Residential) - May 2025</div>
                                        <div class="text-xs text-gray-500">Monthly rent charge • Code: rentres</div>
                                    </td>
                                    <td class="px-6 py-4 text-center">
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">Paid</span>
                                    </td>
                                    <td class="px-6 py-4 text-sm text-right font-medium text-gray-900">$2,000.00</td>
                                    <td class="px-6 py-4 text-sm text-right">-</td>
                                    <td class="px-6 py-4 text-sm text-right font-bold">$1,831.75</td>
                                </tr>

                                <!-- Starting Balance for 2025 -->
                                <tr class="hover:bg-gray-50 table-row" data-page="1">
                                    <td class="px-6 py-4 text-sm text-gray-900">Dec 31, 2024</td>
                                    <td class="px-6 py-4">
                                        <div class="text-sm font-medium text-gray-900">Balance Forward</div>
                                        <div class="text-xs text-gray-500">Carried from previous year • Code: balance</div>
                                    </td>
                                    <td class="px-6 py-4 text-center">
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800">Carried forward</span>
                                    </td>
                                    <td class="px-6 py-4 text-sm text-right">-</td>
                                    <td class="px-6 py-4 text-sm text-right">-</td>
                                    <td class="px-6 py-4 text-sm text-right font-bold">-$168.25</td>
                                </tr>
                            </tbody>
                        </table>
            </div>
        </div>

        <!-- Pagination -->
        <div class="flex items-center justify-center mt-8 gap-6">
            <!-- Pagination Controls -->
            <div class="flex items-center gap-1">
                <!-- Previous Button -->
                <button class="pagination-prev w-8 h-8 flex items-center justify-center border border-gray-300 rounded text-gray-400 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed" disabled onclick="previousPage()">
                    <i class="fas fa-chevron-left text-xs"></i>
                </button>
                
                <!-- Page Numbers -->
                <button class="pagination-page w-8 h-8 text-sm border border-primary bg-primary text-white rounded" data-page="1" onclick="goToPage(1)">1</button>
                <button class="pagination-page w-8 h-8 text-sm border border-gray-300 text-gray-700 hover:bg-gray-50 rounded" data-page="2" onclick="goToPage(2)">2</button>
                
                <!-- Next Button -->
                <button class="pagination-next w-8 h-8 flex items-center justify-center border border-gray-300 rounded text-gray-700 hover:bg-gray-50" onclick="nextPage()">
                    <i class="fas fa-chevron-right text-xs"></i>
                </button>
            </div>
            
            <!-- Records Per Page Selector -->
            <div class="flex items-center gap-2">
                <select class="px-3 py-1 border border-gray-300 rounded text-sm bg-white" onchange="changeRecordsPerPage(this.value)">
                    <option value="10" selected>10</option>
                    <option value="20">20</option>
                    <option value="50">50</option>
                    <option value="100">100</option>
                </select>
                <span class="text-sm text-gray-600">per page</span>
            </div>
        </div>

            
        </div>

        </main>
    </div>

    <!-- Outstanding Balance Pageslide -->
    <div class="pageslide-overlay" id="outstanding-balance-overlay">
        <div class="pageslide" id="outstanding-balance">
            <div class="pageslide-header">
                <div class="flex items-start justify-between w-full">
                    <div class="flex items-start gap-3">
                        <div>
                            <h2 class="pageslide-title text-gray-900 font-semibold text-lg mb-1">Outstanding balance</h2>
                                                    <div class="text-sm text-gray-600">
                            <span class="font-medium">$2,674.50 outstanding</span>
							<span class="text-gray-400 mx-1">•</span>
                            <span class="text-red-600 font-medium ml-2">2 past due</span>
							<span class="text-gray-400 mx-1">•</span>
                            <span class="font-medium">2 current</span>
                            <span class="text-gray-400 mx-1">•</span>
                            <span class="font-medium text-orange-600">1 pending payment</span>
                        </div>
                        </div>
                    </div>
                <button class="pageslide-close">
                    <i class="fas fa-times"></i>
                </button>
                </div>
            </div>
            
            <div class="pageslide-content">
			
				<!-- Search Bar with Action Buttons -->
                <div class="search-container mb-6">
                    <div class="flex items-center gap-3">
                        <!-- Search Field -->
                        <div class="relative flex-1">
                            <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 text-sm"></i>
                            <input 
                                type="text" 
                                placeholder="Search charges..." 
                                class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus-ring-primary text-sm"
                            >
                    </div>
                        
                        <!-- Action Buttons -->
                        <div class="flex items-center gap-2">
                            <button class="btn btn-sm text-sm px-3 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 border-0 focus-ring rounded-lg font-bold">
                                <i class="fas fa-plus text-sm mr-1.5"></i>
                                Add charge
                            </button>
                            
                            <button id="kebab-btn-charges" class="kebab-btn btn btn-sm px-3 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 border-0 focus-ring w-10 h-10 flex items-center justify-center rounded-lg">
                                <i class="fas fa-ellipsis-v text-sm"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Pending Payments Section -->
                <div class="pending-payments-section mb-6">
                    <h3 class="section-title mb-1">Pending payments</h3>
                    <p class="text-xs text-gray-500 mb-4">Payments received within 24 hours, not yet posted</p>
                    
                    <div class="charge-item p-2 rounded-lg" style="border-left: 4px solid #f59e0b;">
                        <div class="flex items-center justify-between">
                            <!-- Left Side -->
                            <div class="flex-1">
                                <h4 class="text-md font-semibold text-gray-900 mb-1">Online Payment - Covers July Past Due</h4>
                                <div class="flex items-center gap-3 mb-2">
                                    <span class="text-sm font-medium">Today</span>
                                    <span class="text-xs font-mono text-grey-600 bg-gray-100 px-2 py-1 rounded">onlinepay</span>
                                </div>
                            </div>
                            
                            <!-- Right Side -->
                            <div class="flex flex-col items-end gap-2">
                                <div class="text-lg font-bold">-$1,337.25</div>
                                <div class="flex items-center gap-3">
                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">Processing</span>
                                </div>
                            </div>
                        </div>

                        <div class="mt-3">
                            <div class="flex items-center gap-2">
                                <i class="fas fa-clock text-orange-500 text-sm"></i>
                                <span class="text-sm text-gray-600">Expected to post within 1-2 business days (covers all past due amounts)</span>
                                </div>
                            </div>
                            </div>
                        </div>

				
                <div class="balance-list-container">
                    <h3 class="section-title">Outstanding charges</h3>
                    
                    <!-- Balanced List View -->
                    <div class="charges-list-container space-y-4">
                        <!-- Past Due Charges -->
                        <div class="charge-item p-3 bg-white border border-gray-200 rounded-lg hover:shadow-md transition-all duration-200" style="border-left: 4px solid #ef4444;">
                            <div class="flex items-center justify-between">
                                <!-- Left Side -->
                                <div class="flex-1">
                                    <h4 class="text-md font-semibold text-gray-900 mb-1">Rent (Residential) (06/2025)</h4>
									<div class="flex items-center gap-3 mb-2">
                                        <span class="text-sm text-gray-500 font-medium">Jul 1, 2025</span>
										<span class="text-xs font-mono text-gray-500 bg-gray-100 px-2 py-1 rounded">rentres</span>
                                </div>
                            </div>
                                
                                <!-- Right Side -->
                                <div class="flex flex-col items-end gap-2">
                                    <div class="text-lg font-bold text-gray-900">$1,307.25</div>
                                    <div class="flex items-center gap-3">
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">past due</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="charge-item p-2 bg-white border border-gray-200 rounded-lg hover:shadow-md transition-all duration-200" style="border-left: 4px solid #ef4444;">
                            <div class="flex items-center justify-between">
                                <!-- Left Side -->
                                <div class="flex-1">
                                    <h4 class="text-md font-semibold text-gray-900 mb-1">Cable (Residential) (06/2025)</h4>
									<div class="flex items-center gap-3 mb-2">
                                        <span class="text-sm text-gray-500 font-medium">Jul 1, 2025</span>
                                        <span class="text-xs font-mono text-gray-500 bg-gray-100 px-2 py-1 rounded">cable</span>
                                </div>
                            </div>
                                
                                <!-- Right Side -->
                                <div class="flex flex-col items-end gap-2">
                                    <div class="text-lg font-bold text-gray-900">$30.00</div>
                                    <div class="flex items-center gap-3">
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">past due</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Current Outstanding Charges -->
                        <div class="charge-item p-2 bg-white border border-gray-200 rounded-lg hover:shadow-md transition-all duration-200">
                            <div class="flex items-center justify-between">
                                <!-- Left Side -->
                                <div class="flex-1">
									<h4 class="text-md font-semibold text-gray-900 mb-1">Rent (Residential) (08/2025)</h4>
                                    <div class="flex items-center gap-3 mb-2">
                                        <span class="text-sm text-gray-500 font-medium">Aug 1, 2025</span>
                                        <span class="text-xs font-mono text-gray-500 bg-gray-100 px-2 py-1 rounded">rentres</span>
                                </div>
                            </div>
                                
                                <!-- Right Side -->
                                <div class="flex flex-col items-end gap-2">
                                    <div class="text-lg font-bold text-gray-900">$1,307.25</div>
                                </div>
                            </div>
                        </div>

                        <div class="charge-item p-2 bg-white border border-gray-200 rounded-lg hover:shadow-md transition-all duration-200">
                            <div class="flex items-center justify-between">
                                <!-- Left Side -->
                                <div class="flex-1">
                                    <h4 class="text-md font-semibold text-gray-900 mb-1">Cable (Residential) (08/2025)</h4>
                                    <div class="flex items-center gap-3 mb-2">
                                        <span class="text-sm text-gray-500 font-medium">Aug 1, 2025</span>
                                        <span class="text-xs font-mono text-gray-500 bg-gray-100 px-2 py-1 rounded">cable</span>
                    </div>
                </div>

                                <!-- Right Side -->
                                <div class="flex flex-col items-end gap-2">
                                    <div class="text-lg font-bold text-gray-900">$30.00</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Payment Summary Section -->
                <div class="payment-summary-section mt-6 p-4 bg-gray-50 rounded-lg">
                    <h4 class="text-md font-bold text-gray-700 mb-4">Payment summary</h4>
                    
                    <div class="payment-summary-grid space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-gray-600">Total charges:</span>
                            <span class="font-medium text-gray-900">$2,674.50</span>
                    </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">Pending payments:</span>
                            <span class="font-medium text-gray-900">$1,337.25</span>
                    </div>
                        <hr class="my-2 border-gray-200">
                        <div class="flex justify-between font-semibold">
                            <span class="text-gray-900">Updated outstanding balance:</span>
                            <span class="text-lg">$1,337.25</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Resident Timeline Pageslide -->
    <div class="pageslide-overlay" id="resident-timeline-overlay">
        <div class="pageslide" id="resident-timeline">
            <div class="pageslide-header">
                <h2 class="pageslide-title">Resident Timeline</h2>
                <button class="pageslide-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="pageslide-content">
                <div class="timeline-summary">
                    <div class="timeline-total">
                        <span class="total-label">Total Residency Duration</span>
                        <span class="total-amount">4.2 years</span>
                    </div>
                    <div class="timeline-status">
                        <span>Excellent resident with strong payment history</span>
                    </div>
                </div>

                <div class="timeline-list-container">
                    <h3 class="section-title">Residency Timeline</h3>
                    
                    <div class="timeline-list">
                        <div class="timeline-item scheduled">
                            <div class="timeline-point scheduled">
                                <i class="fas fa-calendar-times"></i>
                            </div>
                            <div class="timeline-content">
                                <div class="timeline-header">
                                    <span class="timeline-date">Oct 31, 2025</span>
                                    <span class="timeline-status-badge scheduled">scheduled</span>
                                </div>
                                <div class="timeline-title">Lease Expires</div>
                                <div class="timeline-description">Current lease agreement expires</div>
                                <div class="timeline-meta">Lease renewal or move-out decision required</div>
                            </div>
                        </div>

                        <div class="timeline-item current">
                            <div class="timeline-point current">
                                <i class="fas fa-home"></i>
                            </div>
                            <div class="timeline-content">
                                <div class="timeline-header">
                                    <span class="timeline-date">May 15, 2021</span>
                                    <span class="timeline-inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">current</span>
                                </div>
                                <div class="timeline-title">Move In</div>
                                <div class="timeline-description">Started residency at Cityview Towers</div>
                                <div class="timeline-meta">Initial Term: 12 months • Monthly Rent: $1,950.00</div>
                            </div>
                        </div>

                        <div class="timeline-item completed">
                            <div class="timeline-point completed">
                                <i class="fas fa-file-signature"></i>
                            </div>
                            <div class="timeline-content">
                                <div class="timeline-header">
                                    <span class="timeline-date">May 10, 2021</span>
                                    <span class="timeline-status-badge completed">completed</span>
                                </div>
                                <div class="timeline-title">Lease Executed</div>
                                <div class="timeline-description">Signed initial lease agreement for Unit 303C</div>
                                <div class="timeline-meta">Lease Start: May 15, 2021 • Security Deposit: $1,950.00</div>
                            </div>
                        </div>

                        <div class="timeline-item completed">
                            <div class="timeline-point completed">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div class="timeline-content">
                                <div class="timeline-header">
                                    <span class="timeline-date">Apr 25, 2021</span>
                                    <span class="timeline-status-badge completed">completed</span>
                                </div>
                                <div class="timeline-title">Prospect Approved</div>
                                <div class="timeline-description">Rental application approved after background check</div>
                                <div class="timeline-meta">Credit Score: 750 • Income Verification: Approved</div>
                            </div>
                        </div>
                    </div>
                </div>



                <div class="timeline-notes">
                    <h3 class="section-title">Residency Notes</h3>
                    <div class="note-item">
                        <strong>Payment History:</strong> Consistently pays on time, never had late fees
                    </div>
                    <div class="note-item">
                        <strong>Lease Renewals:</strong> Renewed lease 4 times without issues
                    </div>
                    <div class="note-item">
                        <strong>Next Milestone:</strong> Current lease expires October 31, 2025 - renewal decision needed
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Payment History Pageslide -->
    <div class="pageslide-overlay" id="payment-history-overlay">
        <div class="pageslide" id="payment-history">
            <div class="pageslide-header">
                <h2 class="pageslide-title">Payment History</h2>
                <button class="pageslide-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="pageslide-content">
                <div class="payment-summary">
                    <div class="payment-total">
                        <span class="total-label">Payment Performance</span>
                        <span class="total-amount">98% On-Time</span>
                    </div>
                    <div class="payment-status">
                        <span>Showing 2 most recent payments - excellent payment history with 2 late payments out of 51 total</span>
                    </div>
                </div>

                <div class="payment-list-container">
                    <h3 class="section-title">Recent Payment Activity</h3>
                    
                    <div class="payment-list">
                        <div class="payment-item">
                            <div class="payment-item-header">
                                <span class="payment-date">Jun 30, 2025</span>
                                <div class="payment-header-right">
                                    <span class="payment-balance">$2,126.60</span>
                                </div>
                            </div>
                            <div class="payment-item-details">
                                <div class="payment-description">Payment Received - Check #1234</div>
                                <div class="payment-meta">
                                    <span class="payment-code">chk# 1234</span>
                                    <span class="payment-control">R-140811</span>
                                </div>
                            </div>
                        </div>

                        <div class="payment-item">
                            <div class="payment-item-header">
                                <span class="payment-date">May 30, 2025</span>
                                <div class="payment-header-right">
                                    <span class="payment-balance">$1,890.50</span>
                                </div>
                            </div>
                            <div class="payment-item-details">
                                <div class="payment-description">Payment Received - Online Payment</div>
                                <div class="payment-meta">
                                    <span class="payment-code">ACH Transfer</span>
                                    <span class="payment-control">R-139842</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="payment-quick-actions">
                    <button class="payment-quick-btn">
                        <i class="fas fa-print"></i>
                        <span>Print</span>
                    </button>
                    <button class="payment-quick-btn">
                        <i class="fas fa-envelope"></i>
                        <span>Email</span>
                    </button>
                </div>

                <div class="payment-actions">
                    <button class="payment-action-btn primary">
                        <i class="fas fa-credit-card"></i>
                        <span>Receive Payment</span>
                    </button>
                    <button class="payment-action-btn secondary">
                        <i class="fas fa-download"></i>
                        <span>Export Payment History</span>
                    </button>
                </div>

                <div class="payment-notes">
                    <h3 class="section-title">Payment Notes</h3>
                    <div class="note-item">
                        <strong>Payment Method:</strong> Usually pays by check, occasionally online
                    </div>
                    <div class="note-item">
                        <strong>On-Time Rate:</strong> 98% - only 2 late payments in 4.2 years
                    </div>
                    <div class="note-item">
                        <strong>Current Status:</strong> Outstanding balance of $2,380 - positive payment history overall
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Customer Journey Pageslide -->
    <div class="pageslide-overlay" id="customer-journey-overlay">
        <div class="pageslide customer-journey">
            <div class="pageslide-header">
                <h2 class="pageslide-title">Customer Journey</h2>
                <button class="pageslide-close" onclick="closePageslide('customer-journey')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="pageslide-content">
                <!-- Journey Summary -->
                <div class="journey-summary-section">
                    <div class="journey-overview">
                        <div class="journey-stats">
                            <div class="journey-stat">
                                <span class="stat-number">4</span>
                                <span class="stat-label">Properties</span>
                            </div>
                            <div class="journey-stat">
                                <span class="stat-number">4.2</span>
                                <span class="stat-label">Years Active</span>
                            </div>
                            <div class="journey-stat">
                                <span class="stat-number">98%</span>
                                <span class="stat-label">On-Time Rate</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Property History -->
                <div class="journey-history">
                    <h3 class="section-title">Property History</h3>
                    <div class="journey-timeline">
                        <div class="journey-item detailed">
                            <div class="journey-point current"></div>
                            <div class="journey-content">
                                <div class="journey-header">
                                    <span class="journey-property">Cityview Towers</span>
                                    <span class="journey-status current-status">current resident</span>
                                </div>
                                <div class="journey-details">
                                    <div class="journey-date">2025 - Present</div>
                                    <div class="journey-meta">
                                        <span class="unit-info">Unit: 303C</span>
                                        <span class="lease-info">Month to month lease</span>
                                    </div>
                                    <div class="journey-notes">
                                        Current resident with outstanding balance. Generally reliable payment history.
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="journey-item detailed">
                            <div class="journey-point prospect"></div>
                            <div class="journey-content">
                                <div class="journey-header">
                                    <span class="journey-property">Pacific Oaks</span>
                                    <span class="journey-status prospect-status">Prospect</span>
                                </div>
                                <div class="journey-details">
                                    <div class="journey-date">2023</div>
                                    <div class="journey-meta">
                                        <span class="unit-info">Inquired about 1BR units</span>
                                    </div>
                                    <div class="journey-notes">
                                        Applied but decided not to proceed with lease.
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="journey-item detailed">
                            <div class="journey-point prospect"></div>
                            <div class="journey-content">
                                <div class="journey-header">
                                    <span class="journey-property">Sumida Gardens</span>
                                    <span class="journey-status prospect-status">Prospect</span>
                                </div>
                                <div class="journey-details">
                                    <div class="journey-date">2022</div>
                                    <div class="journey-meta">
                                        <span class="unit-info">Inquired about 2BR units</span>
                                    </div>
                                    <div class="journey-notes">
                                        Completed application but was not approved due to credit score.
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="journey-item detailed">
                            <div class="journey-point former"></div>
                            <div class="journey-content">
                                <div class="journey-header">
                                    <span class="journey-property">Gardenview Terrace</span>
                                    <span class="journey-status resident-status">Former Resident</span>
                                </div>
                                <div class="journey-details">
                                    <div class="journey-date">2019 - 2022</div>
                                    <div class="journey-meta">
                                        <span class="unit-info">Unit: 204A</span>
                                        <span class="lease-info">3-year lease term</span>
                                    </div>
                                    <div class="journey-notes">
                                        Excellent resident history. Left in good standing after lease completion.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Journey Actions -->
                <div class="journey-actions-section">
                    <h3 class="section-title">Quick Actions</h3>
                    <div class="journey-action-buttons">
                        <button class="journey-action-btn primary">
                            <i class="fas fa-chart-line"></i>
                            <span>Customer Analytics</span>
                        </button>
                        <button class="journey-action-btn">
                            <i class="fas fa-file-alt"></i>
                            <span>Generate Report</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Contact Edit Pageslide -->
    <div class="pageslide-overlay" id="contact-edit-overlay">
        <div class="pageslide contact-edit">
            <div class="pageslide-header">
                <h2 class="pageslide-title">Edit Resident Information</h2>
                <button class="pageslide-close" onclick="closePageslide('contact-edit-overlay')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="pageslide-content">
                <form class="contact-edit-form">
                    <!-- Contact Section -->
                    <div class="form-section">
                        <h3 class="form-section-title">Contact information</h3>
                        
                        <div class="form-row">
                            <label class="form-label">Preferred name</label>
                            <div class="form-input-group">
                                <input type="text" class="form-input" value="Mel Michaels" placeholder="Enter preferred name">
                            </div>
						</div>
                        <div class="form-row">
                            <label class="form-label">Email</label>
                            <div class="form-input-group">
                                <input type="email" class="form-input" value="kamala.hakuna@email.com" placeholder="Enter email address">
                                <div class="form-input-icon">
                                    <i class="fas fa-envelope"></i>
                                </div>
                            </div>
                            <div class="form-checkbox-group">
                                <input type="checkbox" id="unsubscribe-email" class="form-checkbox">
                                <label for="unsubscribe-email" class="form-checkbox-label">Unsubscribe to all email</label>
                            </div>
                        </div>

                        <div class="form-row">
                            <label class="form-label">Preferred contact method</label>
                            <div class="form-radio-group">
                                <div class="radio-option">
                                    <input type="radio" id="contact-phone" name="preferred-contact" value="phone" class="form-radio">
                                    <label for="contact-phone" class="form-radio-label">Phone</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="contact-email" name="preferred-contact" value="email" class="form-radio">
                                    <label for="contact-email" class="form-radio-label">Email</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="contact-text" name="preferred-contact" value="text" class="form-radio">
                                    <label for="contact-text" class="form-radio-label">Text</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="contact-person" name="preferred-contact" value="in-person" class="form-radio">
                                    <label for="contact-person" class="form-radio-label">In-person</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="contact-none" name="preferred-contact" value="none" class="form-radio" checked>
                                    <label for="contact-none" class="form-radio-label">None</label>
                                </div>
                            </div>
                        </div>

                        <div class="form-row-group">
                            <div class="form-row">
                                <label class="form-label">Cell</label>
                                <div class="phone-input-group">
                                    <select class="country-select">
                                        <option value="US">US</option>
                                    </select>
                                    <input type="tel" class="form-input" value="(555) 123-4567" placeholder="(201) 555-0123">
                                </div>
                            </div>
                            <div class="form-row">
                                <label class="form-label">Home phone</label>
                                <div class="phone-input-group">
                                    <select class="country-select">
                                        <option value="US">US</option>
                                    </select>
                                    <input type="tel" class="form-input" placeholder="(201) 555-0123">
                                </div>
                            </div>
                        </div>

                        <div class="form-row-group">
                            <div class="form-row">
                                <label class="form-label">Office phone</label>
                                <div class="phone-input-group">
                                    <select class="country-select">
                                        <option value="US">US</option>
                                    </select>
                                    <input type="tel" class="form-input" placeholder="(201) 555-0123">
                                </div>
                            </div>
                            <div class="form-row">
                                <label class="form-label">Other phone</label>
                                <div class="phone-input-group">
                                    <select class="country-select">
                                        <option value="US">US</option>
                                    </select>
                                    <input type="tel" class="form-input" placeholder="(201) 555-0123">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Identification Section -->
                    <div class="form-section">
                        <h3 class="form-section-title">Identification</h3>
                        
                        <div class="form-row-group">
                            <div class="form-row">
                                <label class="form-label">First name (legal)</label>
                                <input type="text" class="form-input" value="Kamala" placeholder="Enter name">
                            </div>
                            <div class="form-row">
                                <label class="form-label">Middle name (legal)</label>
                                <input type="text" class="form-input" placeholder="Enter name">
                            </div>
                            <div class="form-row">
                                <label class="form-label">Last name (legal)</label>
                                <input type="text" class="form-input" value="Hakuna" placeholder="Enter name">
                            </div>
                        </div>

                        <div class="form-row-group">
                            <div class="form-row">
                                <label class="form-label">Date of birth</label>
                                <input type="text" class="form-input" value="07/14/****" placeholder="MM/DD/YYYY">
                            </div>
                            <div class="form-row">
                                <label class="form-label">US military service member</label>
                                <select class="form-select">
                                    <option value="">Select...</option>
                                    <option value="yes">Yes</option>
                                    <option value="no">No</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Address Section -->
                    <div class="form-section">
                        <h3 class="form-section-title">Address</h3>
                        
                        <div class="form-row">
                            <label class="form-label">Country <span class="required">*</span></label>
                            <div class="country-input-group">
                                <select class="form-select">
                                    <option value="US" selected>US (United States)</option>
                                </select>
                                <button type="button" class="country-remove-btn">×</button>
                            </div>
                        </div>

                            <div class="form-row">
                            <label class="form-label">Address</label>
                            <input type="text" class="form-input" value="430 S Fairview Avenue 288 Santa Barbara, CA 93117" placeholder="Enter address">
                        </div>
                    </div>

                    <!-- Form Actions -->
                    <div class="form-actions">
                        <button type="button" class="form-btn secondary" onclick="closePageslide('contact-edit-overlay')">Cancel</button>
                        <button type="submit" class="form-btn primary">Save Changes</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Roommate Details Pageslide -->
    <div class="pageslide-overlay" id="roommate-details-overlay">
        <div class="pageslide roommate-details">
            <div class="pageslide-header">
                <h2 class="pageslide-title">Roommate Details</h2>
                <button class="pageslide-close" onclick="closePageslide('roommate-details-overlay')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="pageslide-content">
                <div class="space-y-6">
                    
                    <!-- Roommate #1 - Angela Johnson -->
                    <div class="card hover-lift shadow-soft">
                        <div class="card-content">
                            <div class="flex items-start gap-3">
                                <!-- Avatar -->
                                <div class="w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center flex-shrink-0">
                                    <span class="text-gray-900 font-semibold text-sm">AJ</span>
                                </div>

                                <!-- Roommate Info -->
                                <div class="flex-1 min-w-0">
                                    <div class="flex items-start justify-between mb-1">
                                        <div class="flex items-center gap-3">
                                            <h4 class="font-semibold text-gray-900">Angela Johnson</h4>
                                            <span class="badge bg-amber-100 text-amber-800 text-xs px-2 py-1 rounded-full font-medium">
                                                Application completed
                                            </span>
                                        </div>
                                        <button id="kebab-btn-roommate-angela" class="btn btn-sm px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 focus-ring w-10 h-8 flex items-center justify-center rounded-lg">
                                            <i class="fas fa-ellipsis-v text-sm"></i>
                                        </button>
                                    </div>
                                    <p class="text-sm text-gray-600 mb-2">Preferred name: Ann Johnson</p>
                                    
                                    <!-- Contact Information -->
                                    <div class="space-y-1 text-sm mb-2">
                                        <div class="flex items-center gap-2">
                                            <span class="text-gray-900">(555) 234-5678</span>
                                            <i class="fas fa-phone text-link text-sm cursor-pointer" title="Call"></i>
                                            <i class="fas fa-mobile-alt text-link text-sm cursor-pointer" title="Mobile"></i>
                                        </div>
                                        <div class="flex items-center gap-2">
                                            <span class="text-gray-900">angela.johnson@email.com</span>
                                            <i class="fas fa-envelope text-link text-sm cursor-pointer" title="Send email"></i>
                                        </div>
                                    </div>
                                    
                                    <!-- Badges -->
                                    <div class="flex items-center gap-2 mb-4">
                                        <span class="badge bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded-full font-medium">
                                            lessee
                                        </span>
                                        <span class="badge bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded-full font-medium">
                                            adult
                                        </span>
                                    </div>

                                    <div class="mt-4">
                                        <button class="btn text-sm px-3 py-1.5 bg-primary text-white focus-ring rounded-lg">
                                            <i class="fas fa-paper-plane text-sm mr-1.5"></i>
                                            Send invitation
                                        </button>
                                        <button class="btn text-sm px-3 py-1.5 bg-primary text-white focus-ring rounded-lg ml-2">
                                            <i class="fas fa-check text-sm mr-1.5"></i>
                                            Approve application
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Roommate #2 - John Smith -->
                    <div class="card hover-lift shadow-soft">
                        <div class="card-content">
                            <div class="flex items-start gap-3">
                                <!-- Avatar -->
                                <div class="w-10 h-10 bg-primary-light rounded-full flex items-center justify-center flex-shrink-0">
                                    <span class="text-blue-600 font-semibold text-sm">JS</span>
                                </div>

                                <!-- Roommate Info -->
                                <div class="flex-1 min-w-0">
                                    <div class="flex items-start justify-between mb-1">
                                        <div class="flex items-center gap-3">
                                            <h4 class="font-semibold text-gray-900">John Smith</h4>
                                            <span class="resident-badge current">Current</span>
                                        </div>
                                        <button id="kebab-btn-roommate-john" class="btn btn-sm px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 focus-ring w-10 h-8 flex items-center justify-center rounded-lg">
                                            <i class="fas fa-ellipsis-v text-sm"></i>
                                        </button>
                                    </div>
                                    
                                    <!-- Contact Information -->
                                    <div class="space-y-1 text-sm mb-2">
                                        <div class="flex items-center gap-2">
                                            <span class="text-gray-900">(555) 345-6789</span>
                                            <i class="fas fa-phone text-link text-sm cursor-pointer" title="Call"></i>
                                            <i class="fas fa-mobile-alt text-link text-sm cursor-pointer" title="Mobile"></i>
                                        </div>
                                        <div class="flex items-center gap-2">
                                            <span class="text-gray-900">john.smith@email.com</span>
                                            <i class="fas fa-envelope text-link text-sm cursor-pointer" title="Send email"></i>
                                        </div>
                                    </div>

                                    <!-- Badges -->
                                    <div class="flex items-center gap-2">
                                        <span class="badge bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded-full font-medium">
                                            lessee
                                        </span>
                                        <span class="badge bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded-full font-medium">
                                            adult
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Add Roommate Button -->
                    <div class="add-pet-section">
                        <button class="bt-sm text-sm font-medium px-3 py-1.5" onclick="addNewRoommate()">
                            <i class="fas fa-plus mr-2"></i>
                            Add Roommate
                        </button>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!-- Floating Kebab Dropdown - Angela Johnson (outside all containers) -->
    <div id="kebab-dropdown-roommate-angela" class="hidden bg-white border border-gray-200 rounded-lg shadow-xl py-1 min-w-[180px]" style="position: fixed; z-index: 9999;">
        <button class="kebab-option w-full text-left px-3 py-2 text-sm hover:bg-gray-50 transition-colors">
            <i class="fas fa-pen mr-2" style="color: rgba(0,0,0,0.6);"></i>
            Edit details
        </button>
        <button class="kebab-option w-full text-left px-3 py-2 text-sm hover:bg-gray-50 transition-colors">
            <i class="fas fa-paper-plane mr-2" style="color: rgba(0,0,0,0.6);"></i>
            Send invitation
        </button>
        <button class="kebab-option w-full text-left px-3 py-2 text-sm hover:bg-gray-50 transition-colors">
            <i class="fas fa-check mr-2" style="color: rgba(0,0,0,0.6);"></i>
            Approve application
        </button>
        <button class="kebab-option w-full text-left px-3 py-2 text-sm hover:bg-gray-50 transition-colors">
            <i class="fas fa-user mr-2" style="color: rgba(0,0,0,0.6);"></i>
            View customer record
        </button>
        <hr class="my-1 border-gray-200">
        <button class="kebab-option w-full text-left px-3 py-2 text-sm hover:bg-red-50 text-gray-900 transition-colors">
            <i class="fas fa-times text-red-500 mr-2"></i>
            Remove roommate
        </button>
    </div>

    <!-- Floating Kebab Dropdown - John Smith (outside all containers) -->
    <div id="kebab-dropdown-roommate-john" class="hidden bg-white border border-gray-200 rounded-lg shadow-xl py-1 min-w-[180px]" style="position: fixed; z-index: 9999;">
        <button class="kebab-option w-full text-left px-3 py-2 text-sm hover:bg-gray-50 transition-colors">
            <i class="fas fa-pen mr-2" style="color: rgba(0,0,0,0.6);"></i>
            Edit details
        </button>
        <button class="kebab-option w-full text-left px-3 py-2 text-sm hover:bg-gray-50 transition-colors">
            <i class="fas fa-user mr-2" style="color: rgba(0,0,0,0.6);"></i>
            View customer record
        </button>
        <hr class="my-1 border-gray-200">
        <button class="kebab-option w-full text-left px-3 py-2 text-sm hover:bg-red-50 text-gray-900 transition-colors">
            <i class="fas fa-times text-red-500 mr-2"></i>
            Remove roommate
        </button>
    </div>

    <!-- Pet Details Pageslide -->
    <div class="pageslide-overlay" id="pet-details-overlay">
        <div class="pageslide pet-details">
            <div class="pageslide-header">
                <h2 class="pageslide-title">Pet Details</h2>
                <button class="pageslide-close" onclick="closePageslide('pet-details-overlay')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="pageslide-content">
                <div class="space-y-4">
                    
                    <!-- Pet #1 - Blue (Dog) -->
                    <div class="pet-detail-card">
                        <div class="pet-card-header">
                            <div class="flex items-center gap-3">
                                <div class="pet-avatar">
                                    <i class="fas fa-dog text-gray-900 text-lg"></i>
                                </div>
                                <div>
                                    <h3 class="pet-name">Blue</h3>
                                    <span class="pet-type">Dog</span>
                                </div>
                            </div>
                            <div class="pet-actions">
                                <button class="pet-edit-btn" onclick="editPet('Blue')">
                                    <i class="fas fa-pen text-sm"></i>
                                </button>
                                <button class="pet-delete-btn" onclick="deletePet('Blue')">
                                    <i class="fas fa-trash text-sm"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="pet-card-content">
                            <div class="pet-metadata">
                                <div class="pet-primary-info">
                                    Jack Russell Terrier • Male • 2 years old
                                </div>
                                <div class="pet-secondary-info">
                                    Weight: 10 lbs • Spayed/Neutered: Yes • Service Animal: No
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Pet #2 - Cat (example) -->
                    <div class="pet-detail-card">
                        <div class="pet-card-header">
                            <div class="flex items-center gap-3">
                                <div class="pet-avatar">
                                    <i class="fas fa-cat text-gray-900 text-lg"></i>
                                </div>
                                <div>
                                    <h3 class="pet-name">Whiskers</h3>
                                    <span class="pet-type">Cat</span>
                                </div>
                            </div>
                            <div class="pet-actions">
                                <button class="pet-edit-btn" onclick="editPet('Whiskers')">
                                    <i class="fas fa-pen text-sm"></i>
                                </button>
                                <button class="pet-delete-btn" onclick="deletePet('Whiskers')">
                                    <i class="fas fa-trash text-sm"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="pet-card-content">
                            <div class="pet-metadata">
                                <div class="pet-primary-info">
                                    Domestic Shorthair • Female • 3 years old
                                </div>
                                <div class="pet-secondary-info">
                                    Weight: 8 lbs • Spayed/Neutered: Yes • Service Animal: No
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Add Pet Button -->
                    <div class="add-pet-section">
                        <button class="btn text-sm font-medium" onclick="addNewPet()">
                            <i class="fas fa-plus mr-2"></i>
                            Add Pet
                        </button>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!-- Vehicle Details Pageslide -->
    <div class="pageslide-overlay" id="vehicle-details-overlay">
        <div class="pageslide vehicle-details">
            <div class="pageslide-header">
                <h2 class="pageslide-title">Vehicle Details</h2>
                <button class="pageslide-close" onclick="closePageslide('vehicle-details-overlay')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="pageslide-content">
                <div class="space-y-4">
                    
                    <!-- Vehicle #1 - Honda Civic -->
                    <div class="vehicle-detail-card">
                        <div class="vehicle-card-header">
                            <div class="flex items-center gap-3">
                                <div class="vehicle-avatar">
                                    <i class="fas fa-car text-gray-900 text-lg"></i>
                                </div>
                                <div>
                                    <h3 class="vehicle-name">2019 Honda Civic</h3>
                                    <span class="vehicle-plate">License: ABC-1234 • CA</span>
                                </div>
                            </div>
                            <div class="vehicle-actions">
                                <button class="vehicle-edit-btn" onclick="editVehicle('2019 Honda Civic')">
                                    <i class="fas fa-pen text-sm"></i>
                                </button>
                                <button class="vehicle-delete-btn" onclick="deleteVehicle('2019 Honda Civic')">
                                    <i class="fas fa-trash text-sm"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="vehicle-card-content">
                            <div class="vehicle-metadata">
                                <div class="vehicle-primary-info">
                                    Honda • Civic • 2019
                                </div>
                                <div class="vehicle-secondary-info">
                                    Color: White
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Vehicle #2 - Toyota RAV4 -->
                    <div class="vehicle-detail-card">
                        <div class="vehicle-card-header">
                            <div class="flex items-center gap-3">
                                <div class="vehicle-avatar">
                                    <i class="fas fa-car text-gray-900 text-lg"></i>
                                </div>
                                <div>
                                    <h3 class="vehicle-name">2021 Toyota RAV4</h3>
                                    <span class="vehicle-plate">License: XYZ-5678 • CA</span>
                                </div>
                            </div>
                            <div class="vehicle-actions">
                                <button class="vehicle-edit-btn" onclick="editVehicle('2021 Toyota RAV4')">
                                    <i class="fas fa-pen text-sm"></i>
                                </button>
                                <button class="vehicle-delete-btn" onclick="deleteVehicle('2021 Toyota RAV4')">
                                    <i class="fas fa-trash text-sm"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="vehicle-card-content">
                            <div class="vehicle-metadata">
                                <div class="vehicle-primary-info">
                                    Toyota • RAV4 • 2021
                                </div>
                                <div class="vehicle-secondary-info">
                                    Color: Silver
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Add Vehicle Button -->
                    <div class="add-vehicle-section">
                        <button class="btn text-sm font-medium" onclick="addNewVehicle()">
                            <i class="fas fa-plus mr-2"></i>
                            Add Vehicle
                        </button>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!-- Floating Kebab Dropdown - Resident (outside all containers) -->
    <div id="kebab-dropdown-resident" class="hidden bg-white border border-gray-200 rounded-lg shadow-xl py-1 min-w-[180px]" style="position: fixed; z-index: 9999;">
        <button class="kebab-option w-full text-left px-3 py-2 text-sm hover:bg-gray-50 transition-colors">
            <i class="fas fa-user mr-2" style="color: rgba(0,0,0,0.6);"></i>
            View customer record
        </button>
        <button class="kebab-option w-full text-left px-3 py-2 text-sm hover:bg-gray-50 transition-colors">
            <i class="fas fa-user-plus mr-2" style="color: rgba(0,0,0,0.6);"></i>
            View prospect record
        </button>
    </div>

        <!-- Floating Kebab Dropdown - Lease (outside all containers) -->
    <div id="kebab-dropdown-lease" class="hidden bg-white border border-gray-200 rounded-lg shadow-xl py-1 min-w-[240px]" style="position: fixed; z-index: 9999;">
        <!-- Financial -->
        <div class="kebab-group-header">Financial</div>
        <button class="kebab-option w-full text-left px-3 py-2 text-sm hover:bg-gray-50 transition-colors">
            <i class="fas fa-circle-plus mr-2" style="color: rgba(0,0,0,0.6);"></i>
            Add lease charge
        </button>
        <button class="kebab-option w-full text-left px-3 py-2 text-sm hover:bg-gray-50 transition-colors">
            <i class="fas fa-piggy-bank mr-2" style="color: rgba(0,0,0,0.6);"></i>
            Apply deposit
        </button>
        
        <!-- Lease Operations -->
        <hr class="my-1 border-gray-200">
        <div class="kebab-group-header">Lease Operations</div>
        <button class="kebab-option w-full text-left px-3 py-2 text-sm hover:bg-gray-50 transition-colors">
            <i class="fas fa-file-contract mr-2" style="color: rgba(0,0,0,0.6);"></i>
            Create proposal
        </button>
		<button class="kebab-option w-full text-left px-3 py-2 text-sm hover:bg-gray-50 transition-colors">
            <i class="fas fa-calendar-alt mr-2" style="color: rgba(0,0,0,0.6);"></i>
            Adjust lease-end
        </button>
        <button class="kebab-option w-full text-left px-3 py-2 text-sm hover:bg-gray-50 transition-colors">
            <i class="fas fa-calendar mr-2" style="color: rgba(0,0,0,0.6);"></i>
            Change to month-to-month
        </button>
 		<button class="kebab-option w-full text-left px-3 py-2 text-sm hover:bg-gray-50 transition-colors">
            <i class="fas fa-undo mr-2" style="color: rgba(0,0,0,0.6);"></i>
            Reverse move-in
        </button>
        
        <!-- Unit & Resident -->
        <hr class="my-1 border-gray-200">
        <div class="kebab-group-header">Unit & Resident</div>
        <button class="kebab-option w-full text-left px-3 py-2 text-sm hover:bg-gray-50 transition-colors">
            <i class="fas fa-home mr-2" style="color: rgba(0,0,0,0.6);"></i>
            Assign unit
        </button>
        <button class="kebab-option w-full text-left px-3 py-2 text-sm hover:bg-gray-50 transition-colors">
            <i class="fas fa-exchange-alt mr-2" style="color: rgba(0,0,0,0.6);"></i>
            Transfer unit
        </button>
        <button class="kebab-option w-full text-left px-3 py-2 text-sm hover:bg-gray-50 transition-colors">
            <i class="fas fa-user-plus mr-2" style="color: rgba(0,0,0,0.6);"></i>
            Promote roommate
        </button>
        
        <!-- Termination -->
        <hr class="my-1 border-gray-200">
        <div class="kebab-group-header">Termination</div>
 		<button class="kebab-option w-full text-left px-3 py-2 text-sm hover:bg-gray-50 transition-colors">
            <i class="fas fa-bell mr-2" style="color: rgba(0,0,0,0.6);"></i>
            Give notice
        </button>
 		<button class="kebab-option w-full text-left px-3 py-2 text-sm hover:bg-gray-50 transition-colors">
            <i class="fas fa-exclamation-triangle mr-2" style="color: rgba(0,0,0,0.6);"></i>
            Evict
        </button>
    </div>




    <!-- Floating Kebab Dropdown - Charges Actions (outside all containers) -->
    <div id="kebab-dropdown-charges" class="hidden bg-white border border-gray-200 rounded-lg shadow-xl py-1 min-w-[180px]" style="position: fixed; z-index: 99999;">
        <button class="kebab-option w-full text-left px-3 py-2 text-sm hover:bg-gray-50 transition-colors">
            <i class="fas fa-credit-card mr-2" style="color: rgba(0,0,0,0.6);"></i>
            Receive payment
        </button>
        <button class="kebab-option w-full text-left px-3 py-2 text-sm hover:bg-gray-50 transition-colors">
            <i class="fas fa-print mr-2" style="color: rgba(0,0,0,0.6);"></i>
            Print
        </button>
        <hr class="my-1 border-gray-200">
        <button class="kebab-option w-full text-left px-3 py-2 text-sm hover:bg-gray-50 transition-colors">
            <i class="fas fa-file-excel mr-2" style="color: rgba(0,0,0,0.6);"></i>
            Export to excel
        </button>
        <button class="kebab-option w-full text-left px-3 py-2 text-sm hover:bg-gray-50 transition-colors">
            <i class="fas fa-file-pdf mr-2" style="color: rgba(0,0,0,0.6);"></i>
            Export to PDF
        </button>
    </div>

    <script>
        // Handle Create Proposal button - Global function
        function handleCreateProposal() {
            alert('Create Lease Proposal:\n\n• Review current lease terms\n• Check market rent rates\n• Generate renewal proposal\n• Calculate new rent amount\n• Prepare proposal documents\n• Schedule tenant meeting');
        }
        
        // Handle View All Activities button - Global function
        function viewAllActivities() {
            alert('View All Activities:\n\n• Load complete activity timeline\n• Filter by activity type\n• Search specific dates or events\n• Export activity reports\n• View detailed communication history');
        }
        
        // Track if load more has been clicked - Global variable
        let timelineExpanded = false;
        
        // Handle Add Activity dropdown - Global functions
        function toggleActivityAddMenu() {
            const menu = document.getElementById('activity-add-menu');
            if (menu) {
                menu.classList.toggle('hidden');
            }
        }
        
        function addActivityType(type) {
            // Close the dropdown
            const menu = document.getElementById('activity-add-menu');
            if (menu) menu.classList.add('hidden');
            
            // Handle different activity types
            switch(type) {
                case 'comment':
                    alert('Add Comment:\n\n• Add a comment to the activity timeline\n• Include relevant details and context\n• Tag team members if needed\n• Save for future reference');
                    break;
                case 'follow-up':
                    alert('Add Follow-up:\n\n• Schedule a follow-up task\n• Set due date and priority\n• Add follow-up details\n• Assign to team member\n• Link to previous activities');
                    break;
                case 'appointment':
                    alert('Add Appointment:\n\n• Schedule an appointment\n• Set date and time\n• Add location details\n• Send calendar invites\n• Add appointment notes');
                    break;
                case 'log':
                    alert('Log Activity:\n\n• Record completed activity\n• Document what was done\n• Add outcome and results\n• Set completion status\n• Link to related records');
                    break;
                case 'memo':
                    alert('Add Memo:\n\n• Create internal memo\n• Document important information\n• Add memo subject and content\n• Tag relevant departments\n• Set memo priority');
                    break;
                default:
                    alert('Unknown activity type selected');
            }
        }
        
        // Handle Load More Activities button - Global function
        function loadMoreActivities() {
            const hiddenActivities = document.getElementById('hidden-activities');
            const loadMoreSection = document.getElementById('load-more-section');
            const activityCard = document.getElementById('activity-timeline-card');
            
            if (hiddenActivities && loadMoreSection) {
                // Mark timeline as expanded
                timelineExpanded = true;
                
                // Show all hidden activities
                hiddenActivities.classList.remove('hidden');
                
                // Hide the load more button
                loadMoreSection.style.display = 'none';
                
                // Remove height constraints from activity timeline to let it expand naturally
                if (activityCard) {
                    activityCard.style.minHeight = 'auto';
                    activityCard.style.height = 'auto';
                }
                
                // Show success message
                setTimeout(() => {
                    const countText = loadMoreSection.querySelector('.text-xs');
                    if (countText) {
                        countText.textContent = 'Showing all 10 activity periods';
                    }
                }, 200);
            }
        }
        
        // Handle Add Note button - Global function
        function addNote() {
            alert('Add Note:\n\n• Create new note entry\n• Add note content and description\n• Tag relevant topics or categories\n• Assign priority level\n• Link to resident record\n• Save for future reference');
        }
        
        // Handle View All Notes button - Global function
        function viewAllNotes() {
            alert('View All Notes:\n\n• Load complete notes history\n• Filter by author or date\n• Search note content\n• Export notes reports\n• View detailed note history\n• Manage note categories');
        }
        
        // Pet Details Actions - Global functions
        function editPet(petName) {
            alert(`Edit Pet: ${petName}\n\n• Update pet information\n• Modify weight, age, breed details\n• Upload vaccination records\n• Update service animal status\n• Save changes to resident record`);
        }
        
        function deletePet(petName) {
            if (confirm(`Are you sure you want to remove ${petName} from this resident's record?\n\nThis action cannot be undone.`)) {
                alert(`Pet ${petName} has been removed from the resident record.`);
                // In a real application, this would remove the pet from the database
            }
        }
        
        function addNewPet() {
            alert('Add New Pet:\n\n• Enter pet information\n• Upload pet photos\n• Add vaccination records\n• Set service animal status\n• Complete pet registration\n• Update lease agreement if needed');
        }

        function addNewRoommate() {
            alert('Add New Roommate:\n\n• Add roommate information\n• Set roommate details\n• Update lease agreement\n• Configure access permissions');
        }
        
        // Vehicle Details Actions - Global functions
        function editVehicle(vehicleName) {
            alert(`Edit Vehicle: ${vehicleName}\n\n• Update license plate number\n• Change state registration\n• Modify make, model, year\n• Update vehicle color\n• Save changes to resident record`);
        }
        
        function deleteVehicle(vehicleName) {
            if (confirm(`Are you sure you want to remove ${vehicleName} from this resident's record?\n\nThis action cannot be undone.`)) {
                alert(`Vehicle ${vehicleName} has been removed from the resident record.`);
                // In a real application, this would remove the vehicle from the database
            }
        }
        
        function addNewVehicle() {
            alert('Add New Vehicle:\n\n• Enter license plate number\n• Select state registration\n• Add vehicle make and model\n• Enter vehicle year\n• Specify vehicle color\n• Save to resident record');
        }
        
        // Handle Note Expansion Toggle - Global function
        function toggleNoteExpansion() {
            const notePreview = document.getElementById('note-preview');
            const noteFull = document.getElementById('note-full');
            const noteToggle = document.getElementById('note-toggle');
            
            if (noteFull.classList.contains('hidden')) {
                // Expand note
                noteFull.classList.remove('hidden');
                noteToggle.textContent = 'read less';
            } else {
                // Collapse note
                noteFull.classList.add('hidden');
                noteToggle.textContent = 'read more';
            }
        }
        
        // Toggle alerts section
        function toggleAlerts() {
            const content = document.getElementById('alerts-content');
            const chevron = document.getElementById('alerts-chevron');
            const summary = document.getElementById('alerts-summary');
            
            if (content.style.display === 'none') {
                // Expanding: show content, hide summary
                content.style.display = 'block';
                summary.style.display = 'none';
                chevron.classList.remove('fa-chevron-down');
                chevron.classList.add('fa-chevron-up');
            } else {
                // Collapsing: hide content, show summary
                content.style.display = 'none';
                summary.style.display = 'flex';
                chevron.classList.remove('fa-chevron-up');
                chevron.classList.add('fa-chevron-down');
            }
        }
        
        // Activity filtering functionality
        function filterActivities(filter) {
            const allItems = document.querySelectorAll('.activity-item');
            
            allItems.forEach(item => {
                const itemFilters = item.getAttribute('data-filter') || '';
                
                // Check activity filter
                if (filter === 'all' || itemFilters.includes(filter)) {
                    item.classList.remove('hidden');
                } else {
                    item.classList.add('hidden');
                }
            });
        }
        
        // View switching functionality
        function toggleView(viewName) {
            const overviewView = document.getElementById('overview-view');
            const ledgerView = document.getElementById('ledger-view');
            const overviewMenu = document.getElementById('overview-menu');
            const ledgerMenu = document.getElementById('ledger-menu');
            
            if (viewName === 'overview') {
                // Show overview, hide ledger
                overviewView.style.display = 'block';
                ledgerView.style.display = 'none';
                
                // Update menu states
                overviewMenu.classList.add('active');
                ledgerMenu.classList.remove('active');
            } else if (viewName === 'ledger') {
                // Show ledger, hide overview
                overviewView.style.display = 'none';
                ledgerView.style.display = 'block';
                
                // Update menu states
                overviewMenu.classList.remove('active');
                ledgerMenu.classList.add('active');
            }
        }
        
        // Ledger functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize pagination on page load
            if (document.getElementById('ledger-view')) {
                goToPage(1); // Start on page 1
                updatePaginationButtons();
                setExclusiveLedgerFilter('all'); // Set "All" filter as default
            }
            
            // Balance column toggle
            const showBalance = document.getElementById('show-balance');
            if (showBalance) {
                showBalance.addEventListener('change', function() {
                    const balanceColumns = document.querySelectorAll('th:nth-child(6), td:nth-child(6)');
                    balanceColumns.forEach(col => {
                        col.style.display = this.checked ? '' : 'none';
                    });
                });
            }
            
            // Close kebab menu when clicking outside
            document.addEventListener('click', function(e) {
                const kebabBtn = document.getElementById('ledger-kebab-btn');
                const kebabMenu = document.getElementById('ledger-kebab-menu');
                if (kebabBtn && kebabMenu && !kebabBtn.contains(e.target) && !kebabMenu.contains(e.target)) {
                    kebabMenu.classList.add('hidden');
                }
                
                // Close activity add menu when clicking outside
                const activityBtn = document.getElementById('activity-add-btn');
                const activityMenu = document.getElementById('activity-add-menu');
                if (activityBtn && activityMenu && !activityBtn.contains(e.target) && !activityMenu.contains(e.target)) {
                    activityMenu.classList.add('hidden');
                }
            });
        });
        
        // Ledger kebab menu functions
        function toggleLedgerKebab() {
            const menu = document.getElementById('ledger-kebab-menu');
            if (menu) {
                menu.classList.toggle('hidden');
            }
        }
        
        // Exclusive tab-style filter functionality
        function setExclusiveLedgerFilter(filterType) {
            const allButton = document.getElementById('filter-all');
            const unpaidButton = document.getElementById('filter-unpaid');
            const processingButton = document.getElementById('filter-processing');
            
            // Deactivate all filters
            allButton.classList.remove('active');
            unpaidButton.classList.remove('active');
            processingButton.classList.remove('active');
            
            // Activate the clicked filter
            const clickedButton = document.getElementById('filter-' + filterType);
            clickedButton.classList.add('active');
            
            // Filter table rows
            const tableRows = document.querySelectorAll('tbody tr');
            tableRows.forEach(row => {
                const statusCell = row.querySelector('td:nth-child(3)'); // Status column
                const typeCell = row.querySelector('td:nth-child(2)'); // Type column
                
                if (!statusCell || !typeCell) return;
                
                const status = statusCell.textContent.trim().toLowerCase();
                const type = typeCell.textContent.trim().toLowerCase();
                
                let showRow = false;
                
                if (filterType === 'all') {
                    showRow = true; // Show all rows
                } else if (filterType === 'unpaid') {
                    showRow = status.includes('unpaid');
                } else if (filterType === 'processing') {
                    showRow = status.includes('processing') && type.includes('payment');
                }
                
                row.style.display = showRow ? '' : 'none';
            });
            
            console.log('Filter set to:', filterType);
        }
        
        // Pagination functionality
        let currentPage = 1;
        let recordsPerPage = 10;
        
        function goToPage(pageNumber) {
            currentPage = pageNumber;
            
            // Hide all table rows
            const allRows = document.querySelectorAll('.table-row');
            allRows.forEach(row => {
                row.classList.add('hidden');
            });
            
            // Show rows for current page
            const currentPageRows = document.querySelectorAll(`[data-page="${pageNumber}"]`);
            currentPageRows.forEach(row => {
                row.classList.remove('hidden');
            });
            
            // Update pagination button styling
            const pageButtons = document.querySelectorAll('.pagination-page');
            pageButtons.forEach(btn => {
                btn.classList.remove('border-primary', 'bg-primary', 'text-white');
                btn.classList.add('border-gray-300', 'text-gray-700', 'hover:bg-gray-50');
            });
            
            // Activate clicked page button
            const clickedButton = document.querySelector(`.pagination-page[data-page="${pageNumber}"]`);
            if (clickedButton) {
                clickedButton.classList.add('border-primary', 'bg-primary', 'text-white');
                clickedButton.classList.remove('border-gray-300', 'text-gray-700', 'hover:bg-gray-50');
            }
            
            // Update previous/next button states
            updatePaginationButtons();
            
            console.log('Navigated to page:', pageNumber);
        }
        
        function updatePaginationButtons() {
            const prevButton = document.querySelector('.pagination-prev');
            const nextButton = document.querySelector('.pagination-next');
            
            // Update previous button
            if (currentPage === 1) {
                prevButton.disabled = true;
                prevButton.classList.add('text-gray-400');
                prevButton.classList.remove('text-gray-700');
            } else {
                prevButton.disabled = false;
                prevButton.classList.remove('text-gray-400');
                prevButton.classList.add('text-gray-700');
            }
            
            // Update next button (assuming we have 2 pages total)
            if (currentPage === 2) {
                nextButton.disabled = true;
                nextButton.classList.add('text-gray-400');
                nextButton.classList.remove('text-gray-700');
            } else {
                nextButton.disabled = false;
                nextButton.classList.remove('text-gray-400');
                nextButton.classList.add('text-gray-700');
            }
        }
        
        function previousPage() {
            if (currentPage > 1) {
                goToPage(currentPage - 1);
            }
        }
        
        function nextPage() {
            if (currentPage < 2) { // Assuming 2 pages total
                goToPage(currentPage + 1);
            }
        }
        
        // Records per page functionality
        function changeRecordsPerPage(recordCount) {
            recordsPerPage = parseInt(recordCount);
            console.log('Changed records per page to:', recordCount);
            // Reset to page 1 when changing records per page
            goToPage(1);
        }
        
        function exportToExcel() {
            const menu = document.getElementById('ledger-kebab-menu');
            if (menu) menu.classList.add('hidden');
            alert('Export to Excel:\n\n• Generate Excel file with all transactions\n• Include current filters\n• Download automatically\n• Preserve formatting and calculations');
        }
        
        function exportToPDF() {
            const menu = document.getElementById('ledger-kebab-menu');
            if (menu) menu.classList.add('hidden');
            alert('Export to PDF:\n\n• Generate PDF report\n• Include resident summary\n• Professional formatting\n• Ready for printing or sharing');
        }
        
        function emailReport() {
            const menu = document.getElementById('ledger-kebab-menu');
            if (menu) menu.classList.add('hidden');
            alert('Email Report:\n\n• Send ledger report via email\n• Choose recipients\n• Add custom message\n• Include attachments (PDF/Excel)');
        }
        
        function printLedger() {
            const menu = document.getElementById('ledger-kebab-menu');
            if (menu) menu.classList.add('hidden');
            alert('Print Ledger:\n\n• Print current view\n• Optimize layout for printing\n• Include all visible transactions\n• Print-friendly formatting');
        }
        
        function scheduledReports() {
            const menu = document.getElementById('ledger-kebab-menu');
            if (menu) menu.classList.add('hidden');
            alert('Scheduled Reports:\n\n• Set up automated reports\n• Choose frequency (daily, weekly, monthly)\n• Select recipients\n• Customize report content');
        }

        // Table sorting functionality
        let currentSort = { column: null, direction: 'asc' };
        
        function sortTable(column) {
            const table = document.querySelector('#ledger-view table tbody');
            const rows = Array.from(table.querySelectorAll('tr'));
            
            // Determine sort direction
            if (currentSort.column === column) {
                currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
            } else {
                currentSort.direction = 'asc';
            }
            currentSort.column = column;
            
            // Update sort icons
            updateSortIcons(column, currentSort.direction);
            
            // Sort rows based on column
            rows.sort((a, b) => {
                let aVal, bVal;
                
                switch(column) {
                    case 'date':
                        aVal = new Date(a.cells[0].textContent.trim());
                        bVal = new Date(b.cells[0].textContent.trim());
                        break;
                    case 'description':
                        aVal = a.cells[1].querySelector('.text-sm').textContent.trim().toLowerCase();
                        bVal = b.cells[1].querySelector('.text-sm').textContent.trim().toLowerCase();
                        break;
                    case 'status':
                        aVal = a.cells[2].textContent.trim().toLowerCase();
                        bVal = b.cells[2].textContent.trim().toLowerCase();
                        break;
                    case 'charges':
                        aVal = parseFloat(a.cells[3].textContent.replace(/[$,\-]/g, '')) || 0;
                        bVal = parseFloat(b.cells[3].textContent.replace(/[$,\-]/g, '')) || 0;
                        break;
                    case 'payments':
                        aVal = parseFloat(a.cells[4].textContent.replace(/[$,\-]/g, '')) || 0;
                        bVal = parseFloat(b.cells[4].textContent.replace(/[$,\-]/g, '')) || 0;
                        break;
                    case 'balance':
                        aVal = parseFloat(a.cells[5].textContent.replace(/[$,\-]/g, ''));
                        bVal = parseFloat(b.cells[5].textContent.replace(/[$,\-]/g, ''));
                        break;
                }
                
                if (currentSort.direction === 'asc') {
                    return aVal > bVal ? 1 : aVal < bVal ? -1 : 0;
                } else {
                    return aVal < bVal ? 1 : aVal > bVal ? -1 : 0;
                }
            });
            
            // Reorder table rows
            rows.forEach(row => table.appendChild(row));
        }
        
        function updateSortIcons(sortedColumn, direction) {
            // Reset all sort icons
            document.querySelectorAll('#ledger-view th i').forEach(icon => {
                icon.className = 'fas fa-sort text-xs text-gray-400';
            });
            
            // Update the sorted column icon
            const columnMap = {
                'date': 0,
                'description': 1,
                'status': 2,
                'charges': 3,
                'payments': 4,
                'balance': 5
            };
            
            const columnIndex = columnMap[sortedColumn];
            const icon = document.querySelectorAll('#ledger-view th')[columnIndex].querySelector('i');
            
            if (direction === 'asc') {
                icon.className = 'fas fa-sort-up text-xs text-blue-600';
            } else {
                icon.className = 'fas fa-sort-down text-xs text-blue-600';
            }
        }
        
        // Pageslide functionality - Global functions
        function openPageslide(overlayId) {
            const overlay = document.getElementById(overlayId);
            if (overlay) {
                overlay.classList.add('active');
                document.body.style.overflow = 'hidden'; // Prevent background scrolling
            }
        }

        function closePageslide(overlayId) {
            const overlay = document.getElementById(overlayId);
            if (overlay) {
                overlay.classList.remove('active');
                document.body.style.overflow = ''; // Restore scrolling
            }
        }
        
        // Basic interactivity for the CRM interface
        document.addEventListener('DOMContentLoaded', function() {
            // Kebab menu functionality for both Resident and Lease cards
            function setupKebabMenu(btnId, dropdownId, dropdownWidth = 180) {
                const kebabBtn = document.getElementById(btnId);
                const kebabDropdown = document.getElementById(dropdownId);
                
                if (kebabBtn && kebabDropdown) {
                    kebabBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        
                        // Close all other dropdowns first
                        document.querySelectorAll('[id^="kebab-dropdown-"]').forEach(dropdown => {
                            if (dropdown !== kebabDropdown) {
                                dropdown.classList.add('hidden');
                            }
                        });
                        
                        // Get button position and viewport dimensions
                        const rect = kebabBtn.getBoundingClientRect();
                        const viewportWidth = window.innerWidth;
                        const viewportHeight = window.innerHeight;
                        const dropdownHeight = 150; // Estimated dropdown height
                        
                        // Calculate initial position (right-aligned with button)
                        let left = rect.right - dropdownWidth;
                        let top = rect.bottom + 4;
                        
                        // Adjust horizontal position if dropdown would go off-screen
                        if (left < 10) {
                            // If too far left, align with left edge of button
                            left = rect.left;
                        } else if (left + dropdownWidth > viewportWidth - 10) {
                            // If too far right, position to the left of button
                            left = rect.left - dropdownWidth + rect.width;
                        }
                        
                        // Ensure minimum distance from left edge
                        left = Math.max(10, left);
                        
                        // Adjust vertical position if dropdown would go off-screen
                        if (top + dropdownHeight > viewportHeight - 10) {
                            // Position above the button instead
                            top = rect.top - dropdownHeight - 4;
                        }
                        
                        // Ensure minimum distance from top edge
                        top = Math.max(10, top);
                        
                        // Apply calculated position
                        kebabDropdown.style.left = left + 'px';
                        kebabDropdown.style.top = top + 'px';
                        
                        // Toggle dropdown visibility
                        kebabDropdown.classList.toggle('hidden');
                    });
                }
                
                return { kebabBtn, kebabDropdown };
            }
            
            // Setup all kebab menus (except charges - handled manually below)
            const residentKebab = setupKebabMenu('kebab-btn-resident', 'kebab-dropdown-resident', 180);
            const leaseKebab = setupKebabMenu('kebab-btn-lease', 'kebab-dropdown-lease', 200);
            const roommateAngelaKebab = setupKebabMenu('kebab-btn-roommate-angela', 'kebab-dropdown-roommate-angela', 180);
            const roommateJohnKebab = setupKebabMenu('kebab-btn-roommate-john', 'kebab-dropdown-roommate-john', 180);

            
            // Add charge button functionality
            const addChargeBtn = document.querySelector('.search-container button:first-of-type');
            if (addChargeBtn) {
                addChargeBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    alert('Add Charge:\n\n• Create new charge\n• Select charge type\n• Set amount and due date\n• Apply to resident account');
                });
            }
            
            // Manual setup for charges kebab menu
            const chargesKebabBtn = document.getElementById('kebab-btn-charges');
            const chargesKebabDropdown = document.getElementById('kebab-dropdown-charges');
            
            if (chargesKebabBtn && chargesKebabDropdown) {
                // Setup charges kebab click handler
                chargesKebabBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    // Close all other dropdowns first
                    document.querySelectorAll('[id^="kebab-dropdown-"]').forEach(dropdown => {
                        if (dropdown !== chargesKebabDropdown) {
                            dropdown.classList.add('hidden');
                        }
                    });
                    
                    // Toggle this dropdown
                    const isHidden = chargesKebabDropdown.classList.contains('hidden');
                    
                    if (isHidden) {
                        chargesKebabDropdown.classList.remove('hidden');
                        
                        // Position the dropdown relative to the button
                        const rect = chargesKebabBtn.getBoundingClientRect();
                        const dropdownWidth = 180;
                        const dropdownHeight = 160;
                        
                        // Position dropdown to the left of the button (since it's at the right edge)
                        let left = rect.right - dropdownWidth;
                        let top = rect.bottom + 8;
                        
                        // Ensure dropdown doesn't go off screen
                        const viewportWidth = window.innerWidth;
                        const viewportHeight = window.innerHeight;
                        
                        // Adjust horizontal position if needed
                        if (left < 10) {
                            left = rect.left; // Align with left edge of button if not enough space
                        }
                        if (left + dropdownWidth > viewportWidth - 10) {
                            left = viewportWidth - dropdownWidth - 10;
                        }
                        
                        // Adjust vertical position if needed
                        if (top + dropdownHeight > viewportHeight - 10) {
                            top = rect.top - dropdownHeight - 8; // Show above button
                        }
                        
                        chargesKebabDropdown.style.cssText = `
                            position: fixed !important;
                            left: ${left}px !important;
                            top: ${top}px !important;
                            z-index: 99999 !important;
                            width: 180px !important;
                            display: block !important;
                        `;
                    } else {
                        chargesKebabDropdown.classList.add('hidden');
                        chargesKebabDropdown.style.display = 'none';
                    }
                });
            } else {
                console.error('Charges kebab elements not found');
            }
            
            // Charges kebab menu actions
            const chargesKebabOptions = document.querySelectorAll('#kebab-dropdown-charges .kebab-option');
            chargesKebabOptions.forEach(option => {
                option.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    const action = this.textContent.trim();
                    
                    if (action.includes('Receive payment')) {
                        alert('Receive Payment:\n\n• Process payment\n• Select payment method\n• Apply to outstanding charges\n• Send receipt');
                    } else if (action.includes('Print')) {
                        alert('Print Statement:\n\n• Generate printable statement\n• Include all charges and payments\n• Ready for physical delivery');
                    } else if (action.includes('Export to excel')) {
                        alert('Export to Excel:\n\n• Download detailed spreadsheet\n• All charge and payment data\n• Ready for analysis');
                    } else if (action.includes('Export to PDF')) {
                        alert('Export to PDF:\n\n• Generate PDF statement\n• Professional formatting\n• Ready for email or printing');
                    }
                    
                    // Close the dropdown
                    chargesKebabDropdown.classList.add('hidden');
                    chargesKebabDropdown.style.display = 'none';
                });
            });
            
            // Close dropdowns when clicking outside
            document.addEventListener('click', function(e) {
                const allDropdowns = [
                    residentKebab.kebabDropdown, 
                    leaseKebab.kebabDropdown, 
                    roommateAngelaKebab.kebabDropdown,
                    roommateJohnKebab.kebabDropdown,
                    chargesKebabDropdown
                ];
                const allButtons = [
                    residentKebab.kebabBtn, 
                    leaseKebab.kebabBtn, 
                    roommateAngelaKebab.kebabBtn,
                    roommateJohnKebab.kebabBtn,
                    chargesKebabBtn
                ];
                
                // Check if click is outside all kebab elements
                const clickedDropdown = allDropdowns.find(dropdown => dropdown && dropdown.contains(e.target));
                const clickedButton = allButtons.find(button => button && (button === e.target || button.contains(e.target)));
                
                if (!clickedDropdown && !clickedButton) {
                    allDropdowns.forEach(dropdown => {
                        if (dropdown) {
                            dropdown.classList.add('hidden');
                            // Special handling for charges dropdown which uses direct style manipulation
                            if (dropdown === chargesKebabDropdown) {
                                dropdown.style.display = 'none';
                            }
                        }
                    });
                }
            });
            
            // Close dropdowns when scrolling to prevent positioning issues
            let scrollTimeout;
            function closeAllDropdowns() {
                const allDropdowns = [
                    residentKebab.kebabDropdown, 
                    leaseKebab.kebabDropdown, 
                    roommateAngelaKebab.kebabDropdown,
                    roommateJohnKebab.kebabDropdown,
                    chargesKebabDropdown
                ];
                
                allDropdowns.forEach(dropdown => {
                    if (dropdown) {
                        dropdown.classList.add('hidden');
                        // Special handling for charges dropdown
                        if (dropdown === chargesKebabDropdown) {
                            dropdown.style.display = 'none';
                        }
                    }
                });
                
                // Also close the resident header kebab menu (uses different class system)
                const residentHeaderDropdown = document.querySelector('.resident-kebab-dropdown');
                if (residentHeaderDropdown) {
                    residentHeaderDropdown.classList.remove('active');
                }
            }
            
            function handleScroll(e) {
                // Clear previous timeout
                if (scrollTimeout) {
                    clearTimeout(scrollTimeout);
                }
                
                // Set a small delay to avoid closing during smooth scrolling
                scrollTimeout = setTimeout(closeAllDropdowns, 50);
            }
            
            // Add scroll listeners to document and all scrollable containers
            document.addEventListener('scroll', handleScroll, { passive: true });
            window.addEventListener('scroll', handleScroll, { passive: true });
            
            // Also handle scroll events on pageslides and other containers
            document.querySelectorAll('.pageslide, .main-content, .content-grid').forEach(container => {
                container.addEventListener('scroll', handleScroll, { passive: true });
            });
            
            // Close dropdowns on window resize to prevent positioning issues
            window.addEventListener('resize', function() {
                closeAllDropdowns();
            });
            
            // Handle task action buttons
            document.addEventListener('click', function(e) {
                if (e.target.closest('.task-item button')) {
                    const button = e.target.closest('button');
                    const buttonText = button.textContent.trim();
                    
                    switch(buttonText) {
                        case 'Review Application':
                            alert('Roommate Application Review:\n\n• Review Angela Johnson\'s application\n• Verify background check\n• Approve or request additional information\n• Notify applicant of decision');
                            break;
                        case 'Check Status':
                            alert('Roommate Invitation Status:\n\n• Review John Smith\'s invitation status\n• Send follow-up if needed\n• Check application progress\n• Set reminder for next follow-up');
                            break;
                        case 'Send invitation':
                            alert('Send Roommate Invitation:\n\n• Generate invitation link for Angela Johnson\n• Send via email or SMS\n• Set reminder for follow-up\n• Track invitation status');
                            break;
                        case 'Approve application':
                            alert('Approve Roommate Application:\n\n• Final review of Angela Johnson\'s application\n• Process background check results\n• Generate lease addendum\n• Notify all parties of approval');
                            break;

                        case 'Create proposal':
                            alert('Create Lease Proposal:\n\n• Review current lease terms\n• Check market rent rates\n• Generate renewal proposal\n• Calculate new rent amount\n• Prepare proposal documents\n• Schedule tenant meeting');
                            break;
                        case 'View Details':
                            alert('Work Order Details:\n\nWork Order #26145\n• Date: Aug 17, 2025\n• Category: Appliances\n• Description: Refrigerator is not working\n• Priority: Medium\n• Status: Call\n• View full work order history and notes');
                            break;
                        case 'Complete':
                            alert('Complete Work Order:\n\n• Mark work order #26145 as completed\n• Add completion notes\n• Update resident communication\n• Close work order in system\n• Generate completion report');
                            break;
                    }
                }
            });
            
            // Handle kebab menu option clicks
            document.addEventListener('click', function(e) {
                if (e.target.closest('.kebab-option')) {
                    const button = e.target.closest('.kebab-option');
                    const buttonText = button.textContent.trim();
                    
                    switch(buttonText) {
                        // Add other kebab menu actions here as needed
                    }
                }
            });
            
            // Add click handlers for sidebar menu items
            const menuItems = document.querySelectorAll('.menu-item');
            menuItems.forEach(item => {
                item.addEventListener('click', function() {
                    // Remove active class from all items
                    menuItems.forEach(mi => mi.classList.remove('active'));
                    // Add active class to clicked item
                    this.classList.add('active');
                });
            });

            // Add click handlers for dropdown menus
            const parentMenuItems = document.querySelectorAll('.menu-item.parent');
            parentMenuItems.forEach(item => {
                item.addEventListener('click', function() {
                    this.classList.toggle('expanded');
                });
            });

            // Add click handlers for Add links
            const addLinks = document.querySelectorAll('.add-link');
            addLinks.forEach(link => {
                link.addEventListener('click', function() {
                    alert('Add functionality would open here');
                });
            });

            // Add click handlers for blue links
            const blueLinks = document.querySelectorAll('.info-value.link');
            blueLinks.forEach(link => {
                link.addEventListener('click', function() {
                    alert('Link clicked: ' + this.textContent);
                });
            });

            // Add search functionality
            const searchInput = document.querySelector('.search-input');
            const searchBtn = document.querySelector('.search-btn');
            
            searchBtn.addEventListener('click', function() {
                const searchTerm = searchInput.value;
                if (searchTerm) {
                    alert('Searching for: ' + searchTerm);
                } else {
                    alert('Please enter a search term');
                }
            });

            // Enter key for search
            searchInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    searchBtn.click();
                }
            });

            // Add click handlers for header action buttons
            const actionBtns = document.querySelectorAll('.action-btn');
            actionBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const icon = this.querySelector('i');
                    if (icon) {
                        const iconClass = icon.className;
                        if (iconClass.includes('calendar')) {
                            alert('Calendar view would open here');
                        } else if (iconClass.includes('calculator')) {
                            alert('Calculator would open here');
                        } else if (iconClass.includes('star')) {
                            alert('Favorites would open here');
                        } else if (iconClass.includes('question')) {
                            alert('Help would open here');
                        } else if (iconClass.includes('cog')) {
                            alert('Settings would open here');
                        }
                    } else if (this.textContent === '0') {
                        alert('Notifications would open here');
                    }
                });
            });

            // Add click handler for Add New button
            const addNewBtn = document.querySelector('.add-new-btn');
            if (addNewBtn) {
            addNewBtn.addEventListener('click', function() {
                alert('Add New menu would open here');
            });
            }

            // Add click handler for user profile
            const userProfile = document.querySelector('.user-profile');
            if (userProfile) {
            userProfile.addEventListener('click', function() {
                alert('User profile menu would open here');
            });
            }

            // Add click handler for Verify ID button
            const verifyBtn = document.querySelector('.verified-badge');
            if (verifyBtn) {
            verifyBtn.addEventListener('click', function() {
                alert('ID Verification process would start here');
            });
            }





            // Resident action buttons for email, call, SMS
            const residentActionBtns = document.querySelectorAll('.resident-action-btn');
            residentActionBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    if (this.classList.contains('email')) {
                        alert('Send Email to Kamala Hakuna:\n\n• Compose new message\n• Use template\n• Send reminder\n• Schedule email');
                    } else if (this.classList.contains('call')) {
                        alert('Call Kamala Hakuna:\n\n• Primary phone: (555) 123-4567\n• Emergency contact: (555) 987-6543\n• Log call\n• Schedule callback');
                    } else if (this.classList.contains('sms')) {
                        alert('Send SMS to Kamala Hakuna:\n\n• Quick message\n• Payment reminder\n• Maintenance notice\n• Custom message');
                    }
                });
            });

            // Resident kebab menu functionality
            const residentKebabBtn = document.querySelector('.resident-kebab-btn');
            const residentKebabDropdown = document.querySelector('.resident-kebab-dropdown');
            
            if (residentKebabBtn && residentKebabDropdown) {
                residentKebabBtn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    residentKebabDropdown.classList.toggle('active');
                });

                // Close dropdown when clicking outside
                document.addEventListener('click', function(e) {
                    if (!residentKebabBtn.contains(e.target) && !residentKebabDropdown.contains(e.target)) {
                        residentKebabDropdown.classList.remove('active');
                    }
                });
                
                // Close dropdown when scrolling to prevent positioning issues
                function closeResidentDropdown() {
                    residentKebabDropdown.classList.remove('active');
                }
                
                document.addEventListener('scroll', closeResidentDropdown, { passive: true });
                window.addEventListener('scroll', closeResidentDropdown, { passive: true });
                document.querySelectorAll('.pageslide, .main-content, .content-grid').forEach(container => {
                    container.addEventListener('scroll', closeResidentDropdown, { passive: true });
                });
                window.addEventListener('resize', closeResidentDropdown);

                // Handle kebab menu options
                const residentKebabOptions = document.querySelectorAll('.resident-kebab-option');
                residentKebabOptions.forEach(option => {
                    option.addEventListener('click', function(e) {
                        e.stopPropagation();
                        const action = this.getAttribute('data-action');
                        const actionText = this.querySelector('span').textContent;
                        
                        residentKebabDropdown.classList.remove('active');
                        
                        switch(action) {
                            case 'renew-lease':
                                alert('Renew Lease for Kamala Hakuna:\n\n• New lease terms\n• Rental rate adjustment\n• Lease duration\n• Start date\n• Additional clauses');
                                break;
                            case 'receive':
                                alert('Receive Payment for Kamala Hakuna:\n\n• Payment Amount\n• Payment Method (Cash, Check, Card, ACH)\n• Payment Date\n• Reference Number\n• Notes');
                                break;
                            case 'add-charge':
                                alert('Add Charge for Kamala Hakuna:\n\n• Charge Type\n• Amount\n• Description\n• Due Date\n• Recurring Options');
                                break;
                            case 'add-lease-charge':
                                alert('Add Lease Charge for Kamala Hakuna:\n\n• Lease Charge Type\n• Amount\n• Effective Date\n• Lease Terms\n• Approval Required');
                                break;
                            case 'transfer-unit':
                                alert('Transfer Unit for Kamala Hakuna:\n\n• Select New Unit\n• Transfer Date\n• Reason for Transfer\n• Update Lease Terms\n• Notify Resident');
                                break;
                            case 'reverse-move-in':
                                alert('Reverse Move In for Kamala Hakuna:\n\n• Cancel move-in process\n• Restore previous status\n• Adjust charges\n• Update lease status\n• Generate documentation');
                                break;
                            case 'assign-unit':
                                alert('Assign Unit for Kamala Hakuna:\n\n• Select available unit\n• Set move-in date\n• Configure lease terms\n• Assign keys\n• Send welcome package');
                                break;
                            case 'apply-deposit':
                                alert('Apply Deposit for Kamala Hakuna:\n\n• Select deposit type\n• Apply to charges\n• Remaining balance\n• Transaction notes\n• Receipt generation');
                                break;
                            case 'adjust-lease-end':
                                alert('Adjust Lease End for Kamala Hakuna:\n\n• New end date\n• Reason for change\n• Prorated adjustments\n• Notice requirements\n• Documentation');
                                break;
                            case 'evict':
                                alert('Eviction Process for Kamala Hakuna:\n\n• Legal notice generation\n• Court filing options\n• Timeline tracking\n• Documentation requirements\n• Communication log');
                                break;
                            case 'month-to-month':
                                alert('Convert to Month-to-Month for Kamala Hakuna:\n\n• Update lease terms\n• New rental rate\n• Notice period settings\n• Automatic renewal options\n• Documentation updates');
                                break;
                            case 'notice':
                                alert('Send Notice to Kamala Hakuna:\n\n• Notice type selection\n• Custom message\n• Delivery method\n• Legal compliance\n• Tracking and follow-up');
                                break;
                            case 'promote-roommate':
                                alert('Promote Roommate for Kamala Hakuna:\n\n• Select roommate\n• Transfer lease responsibility\n• Update lease agreement\n• Credit check requirements\n• Legal documentation');
                                break;
                            default:
                                alert(`${actionText} selected`);
                        }
                    });
                });
            }

            // Suggested actions functionality
            const actionSuggestions = document.querySelectorAll('.action-suggestion');
            actionSuggestions.forEach(btn => {
                btn.addEventListener('click', function() {
                    const actionText = this.querySelector('span').textContent;
                    
                    if (this.classList.contains('reminder')) {
                        alert('Send Payment Reminder:\n\n• Email reminder about overdue balance\n• Include payment options\n• Set follow-up date\n• Log communication');
                    } else if (this.classList.contains('call')) {
                        alert('Call Resident:\n\n• Phone: (555) 123-4567\n• Discuss overdue payment\n• Offer payment plan options\n• Log call notes');
                    } else if (this.classList.contains('payment-plan')) {
                        alert('Create Payment Plan:\n\n• Set monthly installments\n• Choose payment dates\n• Define terms and conditions\n• Send agreement for signature');
                    } else if (this.classList.contains('schedule')) {
                        alert('Schedule Renewal Meeting:\n\n• Available dates and times\n• Meeting location options\n• Lease renewal terms to discuss\n• Send calendar invite');
                    } else if (this.classList.contains('renew')) {
                        alert('Renew Lease:\n\n• Generate renewal agreement\n• Update lease terms\n• Set new rental amount\n• Schedule signing appointment');
                    }
                });
            });

            // Clone icon functionality for customer information
            const cloneIcon = document.querySelector('.fa-clone');
            if (cloneIcon) {
                cloneIcon.addEventListener('click', function(e) {
                    e.preventDefault();
                    alert('Customer Profile:\n\n• Customer found across multiple properties\n• View unified customer journey\n• Access all property interactions\n• Cross-property payment history');
                });
            }

            // Section edit button functionality
            const sectionEditBtn = document.querySelector('.section-edit-btn');
            if (sectionEditBtn) {
                sectionEditBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    openPageslide('contact-edit-overlay');
                });
            }

            // Customer ID link functionality
            const customerIdLink = document.querySelector('.customer-id-link');
            if (customerIdLink) {
                customerIdLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    alert('View Customer Record:\n\n• Complete customer history\n• All property interactions\n• Application timeline\n• Cross-property payments\n• Communication log\n• Document repository');
                });
            }

            // Prospect ID link functionality
            const prospectIdElements = document.querySelectorAll('.info-value.link');
            prospectIdElements.forEach(element => {
                if (element.textContent.includes('p0012456')) {
                    element.addEventListener('click', function(e) {
                        e.preventDefault();
                        alert('View Prospect Record:\n\n• Original application details\n• Prospect journey at this property\n• Application timeline\n• Communication history\n• Lead source information');
                    });
                }
            });

            // Add links functionality for Roommates, Vehicles, and Pets
            const residentAddLinks = document.querySelectorAll('.add-link');
            residentAddLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const parentRow = this.closest('.info-row');
                    const label = parentRow.querySelector('.info-label').textContent;
                    
                    if (label.includes('Roommates')) {
                        alert('Add Roommate:\n\n• Add roommate information\n• Set roommate details\n• Update lease agreement\n• Configure access permissions');
                    } else if (label.includes('Vehicles')) {
                        alert('Add Vehicle:\n\n• Enter license plate number\n• Select state registration\n• Add vehicle make and model\n• Enter vehicle year\n• Specify vehicle color');
                    } else if (label.includes('Pets')) {
                        alert('Add Pet:\n\n• Pet type and breed\n• Pet registration\n• Vaccination records\n• Pet deposit/fees');
                    }
                });
            });

            // Roommate link functionality
            const roommateLink = document.querySelector('.roommate-link');
            if (roommateLink) {
                roommateLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    openPageslide('roommate-details-overlay');
                });
            }

            // Journey action buttons
            const journeyActionBtns = document.querySelectorAll('.journey-action-btn');
            journeyActionBtns.forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const action = this.querySelector('span').textContent;
                    alert(`${action} would open here`);
                });
            });

            // Stat card interactions
            const statCards = document.querySelectorAll('.stat-card');
            statCards.forEach(card => {
                card.addEventListener('click', function(e) {
                    const pageslideId = this.getAttribute('data-pageslide');
                    const label = this.querySelector('.stat-label').textContent;
                    const value = this.querySelector('.stat-value').textContent;
                    
                    if (pageslideId) {
                        // Open pageslide for monthly charges
                        openPageslide(pageslideId + '-overlay');
                    } else {
                        // Show alert for other stat cards that don't have pageslides
                    }
                });
            });

            // Customer journey button
            const customerJourneyBtn = document.querySelector('.customer-journey-btn');
            if (customerJourneyBtn) {
                customerJourneyBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    openPageslide('customer-journey-overlay');
                });
            }

            // Close pageslide when clicking overlay or close button
            const pageslideOverlays = document.querySelectorAll('.pageslide-overlay');
            pageslideOverlays.forEach(overlay => {
                overlay.addEventListener('click', function(e) {
                    if (e.target === overlay) {
                        closePageslide(overlay.id);
                    }
                });

                const closeBtn = overlay.querySelector('.pageslide-close');
                if (closeBtn) {
                    closeBtn.addEventListener('click', function() {
                        closePageslide(overlay.id);
                    });
                }
            });

            // Pageslide action buttons
            const chargesActionBtns = document.querySelectorAll('.charges-action-btn');
            chargesActionBtns.forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const actionText = this.querySelector('span').textContent;
                    
                    if (actionText.includes('Add Lease Charge')) {
                        alert('Add Lease Charge form would open:\n\n• Charge Type (Rent, Fee, etc.)\n• Amount\n• Effective Date\n• Description\n• Recurring Options');
                    } else if (actionText.includes('Export Details')) {
                        alert('Export options would open:\n\n• PDF Report\n• CSV Export\n• Excel Spreadsheet\n• Email Report');
                    }
                });
            });

            // Balance action buttons
            const balanceActionBtns = document.querySelectorAll('.balance-action-btn');
            balanceActionBtns.forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const actionText = this.querySelector('span').textContent;
                    
                    if (actionText.includes('Receive Payment')) {
                        alert('Payment Recording form would open:\n\n• Payment Amount: $2,100.00\n• Payment Method (Cash, Check, Card, ACH)\n• Payment Date\n• Reference Number\n• Notes');
                    } else if (actionText.includes('Add Charge')) {
                        alert('Add Charge interface would open:\n\n• Charge Type (Rent, Fee, etc.)\n• Amount\n• Due Date\n• Description\n• Billing Category');
                    } else if (actionText.includes('Send Reminder')) {
                        alert('Notice Options would open:\n\n• Email overdue notice\n• Generate printed letter\n• Schedule follow-up call\n• Set payment reminder\n• Escalate to collections');
                    } else if (actionText.includes('Export Statement')) {
                        alert('Statement Export options:\n\n• PDF Account Statement\n• Detailed Transaction Report\n• Payment History CSV\n• Email to Resident\n• Print for Files');
                    }
                });
            });

            // Timeline action buttons
            const timelineActionBtns = document.querySelectorAll('.timeline-action-btn');
            timelineActionBtns.forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const actionText = this.querySelector('span').textContent;
                    
                    if (actionText.includes('Add Timeline Event')) {
                        alert('Add Timeline Event form would open:\n\n• Event Type (Move In, Lease Renewal, etc.)\n• Date\n• Description\n• Notes\n• Attachments');
                    } else if (actionText.includes('Edit Timeline')) {
                        alert('Timeline Management interface would open:\n\n• Modify existing events\n• Update dates and descriptions\n• Add additional notes\n• Manage event visibility');
                    } else if (actionText.includes('Export Timeline')) {
                        alert('Timeline Export options:\n\n• PDF Timeline Report\n• Detailed Event History\n• CSV Export\n• Email to Resident\n• Print for Files');
                    }
                });
            });

            // Payment action buttons
            const paymentActionBtns = document.querySelectorAll('.payment-action-btn');
            paymentActionBtns.forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const actionText = this.querySelector('span').textContent;
                    
                    if (actionText.includes('Receive Payment')) {
                        alert('Receive Payment form would open:\n\n• Payment Amount\n• Payment Method (Cash, Check, Card, ACH)\n• Payment Date\n• Reference Number\n• Notes');
                    } else if (actionText.includes('Export Payment History')) {
                        alert('Export Payment History options:\n\n• PDF Payment Report\n• CSV Transaction Export\n• Excel Payment History\n• Email Payment Summary');
                    }
                });
            });

            // Payment quick action buttons
            const paymentQuickBtns = document.querySelectorAll('.payment-quick-btn');
            paymentQuickBtns.forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const actionText = this.querySelector('span').textContent;
                    
                    if (actionText.includes('Print')) {
                        alert('Print Payment History:\n\n• Print payment summary\n• Print detailed payment list\n• Print payment receipt\n• Print for files');
                    } else if (actionText.includes('Email')) {
                        alert('Email Payment History:\n\n• Send payment summary to resident\n• Email payment receipt\n• Send to management team\n• Custom email recipient');
                    }
                });
            });

            // Close pageslide with ESC key
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    pageslideOverlays.forEach(overlay => {
                        if (overlay.classList.contains('active')) {
                            closePageslide(overlay.id);
                        }
                    });
                }
            });

            // Roommate edit button functionality
            const roommateEditBtn = document.querySelector('.roommate-edit-btn');
            if (roommateEditBtn) {
                roommateEditBtn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    alert('Edit Roommate form would open:\n\n• Update contact information\n• Modify residency dates\n• Edit personal details\n• Update emergency contacts');
                });
            }

            // Roommate kebab menu option handlers
            const roommateKebabOptions = document.querySelectorAll('#kebab-dropdown-roommate-angela .kebab-option, #kebab-dropdown-roommate-john .kebab-option');
            roommateKebabOptions.forEach(option => {
                option.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    const action = this.textContent.trim();
                    const parentDropdown = this.closest('[id*="kebab-dropdown-roommate"]');
                    const isAngela = parentDropdown && parentDropdown.id.includes('angela');
                    const roommateType = isAngela ? 'Angela Johnson (Pending Application)' : 'John Smith (Current Resident)';
                    
                    // Close the dropdown
                    parentDropdown.classList.add('hidden');
                    
                    if (action.includes('Edit details')) {
                        alert(`Edit ${roommateType}:\n\n• Update contact information\n• Modify residency dates\n• Edit personal details\n• Update emergency contacts`);
                    } else if (action.includes('Send invitation')) {
                        alert(`Send Invitation to ${roommateType}:\n\n• Generate invitation link\n• Send via email or SMS\n• Set reminder for follow-up\n• Track invitation status`);
                    } else if (action.includes('Approve application')) {
                        alert(`Approve Application for ${roommateType}:\n\n• Final review of application\n• Process background check results\n• Generate lease addendum\n• Notify all parties of approval`);
                    } else if (action.includes('View customer record')) {
                        alert(`View Customer Record for ${roommateType}:\n\n• Complete customer history\n• All property interactions\n• Application timeline\n• Cross-property payments\n• Communication log`);
                    } else if (action.includes('Remove roommate')) {
                        if (confirm(`Are you sure you want to remove ${roommateType} from this lease?`)) {
                            alert(`${roommateType} would be removed from the lease.`);
                        }
                    }
                });
            });

            // View Customer Record button functionality
            const viewRecordBtn = document.querySelector('.view-record-btn');
            if (viewRecordBtn) {
                viewRecordBtn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    alert('Navigate to Customer Record:\n\n• Full customer profile\n• Account history\n• Payment records\n• Communication log');
                });
            }

            // Contact action buttons
            const contactActionBtns = document.querySelectorAll('.contact-action-btn');
            contactActionBtns.forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const icon = this.querySelector('i');
                    const contactItem = this.closest('.contact-item');
                    const contactValue = contactItem.querySelector('.contact-value').textContent;
                    
                    if (icon.classList.contains('fa-envelope')) {
                        alert(`Send Email to ${contactValue}:\n\n• Compose email message\n• Select email template\n• Add attachments\n• Schedule send time`);
                    } else if (icon.classList.contains('fa-phone')) {
                        alert(`Call ${contactValue}:\n\n• Initiate phone call\n• Add call to calendar\n• Log call details\n• Set follow-up reminder`);
                    } else if (icon.classList.contains('fa-mobile-alt')) {
                        alert(`Send Text to ${contactValue}:\n\n• Compose SMS message\n• Send instant message\n• Schedule text message\n• Add to message thread`);
                    }
                });
            });

            // Roommate counter functionality
            const roommateCounter = document.querySelector('.roommate-counter');
            if (roommateCounter) {
                roommateCounter.addEventListener('click', function() {
                    openPageslide('roommate-details-overlay');
                });
            }

            // Kebab menu functionality
            const kebabBtns = document.querySelectorAll('.charge-kebab-menu .kebab-btn');
            kebabBtns.forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const menu = this.parentElement;
                    
                    // Close all other kebab menus
                    document.querySelectorAll('.charge-kebab-menu').forEach(otherMenu => {
                        if (otherMenu !== menu) {
                            otherMenu.classList.remove('active');
                        }
                    });
                    
                    // Toggle current menu
                    menu.classList.toggle('active');
                });
            });

            // Close kebab menus when clicking outside
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.charge-kebab-menu')) {
                    document.querySelectorAll('.charge-kebab-menu').forEach(menu => {
                        menu.classList.remove('active');
                    });
                }
                

            });

            // Kebab menu option handlers
            const kebabOptions = document.querySelectorAll('.kebab-option');
            kebabOptions.forEach(option => {
                option.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const action = this.classList.contains('edit-charge') ? 'edit' : 'delete';
                    const chargeItem = this.closest('.charge-item');
                    const chargeName = chargeItem.querySelector('.balance-description').textContent;
                    const chargeAmount = chargeItem.querySelector('.charge-amount').textContent;
                    
                    if (action === 'edit') {
                        alert(`Edit Charge: ${chargeName}\n\nCurrent Amount: ${chargeAmount}\n\n• Modify amount\n• Update description\n• Change effective date\n• Adjust recurring settings`);
                    } else if (action === 'delete') {
                        if (confirm(`Are you sure you want to delete "${chargeName}" (${chargeAmount})?`)) {
                            alert(`Charge "${chargeName}" would be deleted from the lease.`);
                        }
                    }
                    
                    // Close menu after action
                    this.closest('.charge-kebab-menu').classList.remove('active');
                });
            });

            // Health score tooltip positioning
            const healthTooltip = document.querySelector('.health-score-tooltip');
            const tooltipContent = document.querySelector('.tooltip-content');
            
            if (healthTooltip && tooltipContent) {
                healthTooltip.addEventListener('mouseenter', function() {
                    const rect = this.getBoundingClientRect();
                    
                    // Position tooltip below the health score indicator
                    const left = rect.left + (rect.width / 2) - (280 / 2); // Center horizontally, 280 is tooltip width
                    const top = rect.bottom + 10; // Position below with 10px gap
                    
                    tooltipContent.style.left = `${Math.max(10, left)}px`; // Ensure it doesn't go off screen
                    tooltipContent.style.top = `${top}px`;
                });
            }

            // Contact edit form handling
            const contactEditForm = document.querySelector('.contact-edit-form');
            if (contactEditForm) {
                contactEditForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    // Get form data
                    const formData = new FormData(this);
                    const firstName = document.querySelector('input[placeholder="Enter name"]').value;
                    const lastName = document.querySelector('input[value="Hakuna"]').value;
                    const email = document.querySelector('input[type="email"]').value;
                    const phone = document.querySelector('input[value="(555) 123-4567"]').value;
                    const preferredContact = document.querySelector('input[name="preferred-contact"]:checked')?.value;
                    
                    // Show success message
                    alert(`Contact Information Updated Successfully!\n\n` +
                          `Name: ${firstName} ${lastName}\n` +
                          `Email: ${email}\n` +
                          `Phone: ${phone}\n` +
                          `Preferred Contact: ${preferredContact || 'None'}\n\n` +
                          `Changes have been saved to the customer profile.`);
                    
                    // Close the pageslide
                    closePageslide('contact-edit-overlay');
                });
            }

            // Dynamic height matching for columns including activity timeline
            function matchColumnHeights() {
                const column1 = document.getElementById('column-1-resident-notes');
                const column2 = document.getElementById('column-2-lease-info');
                const activityCard = document.getElementById('activity-timeline-card');
                
                if (column1 && column2) {
                    // Reset heights to auto to get natural heights
                    column1.style.minHeight = 'auto';
                    column2.style.minHeight = 'auto';
                    column1.style.height = 'auto';
                    column2.style.height = 'auto';
                    
                    // Only reset activity card height if timeline hasn't been expanded
                    if (activityCard && !timelineExpanded) {
                        activityCard.style.minHeight = 'auto';
                        activityCard.style.height = 'auto';
                    }
                    
                    // Force a reflow to get accurate measurements
                    column1.offsetHeight;
                    column2.offsetHeight;
                    
                    // Get the natural heights after small delay
                    setTimeout(() => {
                        const height1 = column1.offsetHeight;
                        const height2 = column2.offsetHeight;
                        
                        // Calculate the maximum height of the left columns
                        const maxHeight = Math.max(height1, height2);
                        column1.style.minHeight = maxHeight + 'px';
                        column2.style.minHeight = maxHeight + 'px';
                        
                        // Only match activity timeline card height if timeline hasn't been expanded
                        if (activityCard && !timelineExpanded) {
                            activityCard.style.minHeight = maxHeight + 'px';
                        }
                        
                        // Debug log (remove in production)
                        console.log('Height matching applied:', {
                            column1Height: height1,
                            column2Height: height2,
                            maxHeight: maxHeight,
                            activityCardMatched: !!activityCard && !timelineExpanded,
                            timelineExpanded: timelineExpanded
                        });
                    }, 10);
                } else {
                    console.log('Column elements not found:', {
                        column1: !!column1,
                        column2: !!column2,
                        activityCard: !!activityCard
                    });
                }
            }

            // Call height matching on page load (with small delay to ensure content is loaded)
            setTimeout(matchColumnHeights, 100);

            // Re-match heights when window is resized
            window.addEventListener('resize', function() {
                // Debounce the resize event
                clearTimeout(window.resizeTimeout);
                window.resizeTimeout = setTimeout(matchColumnHeights, 250);
            });

            // Re-match heights when content changes (e.g., pageslide opens/closes)
            const observeContentChanges = function() {
                const observer = new MutationObserver(function(mutations) {
                    let shouldUpdate = false;
                    mutations.forEach(function(mutation) {
                        // Check if any changes affect the two-column layout
                        if (mutation.target.closest('#two-column-layout') || 
                            mutation.target.id === 'column-1-resident-notes' ||
                            mutation.target.id === 'column-2-lease-info') {
                            shouldUpdate = true;
                        }
                    });
                    
                    if (shouldUpdate) {
                        // Debounce the height matching
                        clearTimeout(window.heightMatchTimeout);
                        window.heightMatchTimeout = setTimeout(matchColumnHeights, 100);
                    }
                });

                // Observe changes in the two-column layout
                const twoColumnLayout = document.getElementById('two-column-layout');
                if (twoColumnLayout) {
                    observer.observe(twoColumnLayout, {
                        childList: true,
                        subtree: true,
                        attributes: true,
                        attributeFilter: ['style', 'class']
                    });
                }
            };

            // Start observing content changes
            observeContentChanges();

        });


    </script>
</body>
</html>

